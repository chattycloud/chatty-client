/*!
 * ChattyClient v1.2.0
 * Build at 2023.4.1
 * Released under the MIT License.
 */
!function (e, t) { "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define(["exports"], t) : t((e = "undefined" != typeof globalThis ? globalThis : e || self).io = {}) }(this, (function (e) { "use strict"; function t(e, t) { var n = Object.keys(e); if (Object.getOwnPropertySymbols) { var r = Object.getOwnPropertySymbols(e); t && (r = r.filter((function (t) { return Object.getOwnPropertyDescriptor(e, t).enumerable }))), n.push.apply(n, r) } return n } function n(e) { for (var n = 1; n < arguments.length; n++) { var r = null != arguments[n] ? arguments[n] : {}; n % 2 ? t(Object(r), !0).forEach((function (t) { h(e, t, r[t]) })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : t(Object(r)).forEach((function (t) { Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t)) })) } return e } function r() { r = function () { return e }; var e = {}, t = Object.prototype, n = t.hasOwnProperty, i = Object.defineProperty || function (e, t, n) { e[t] = n.value }, o = "function" == typeof Symbol ? Symbol : {}, s = o.iterator || "@@iterator", a = o.asyncIterator || "@@asyncIterator", c = o.toStringTag || "@@toStringTag"; function u(e, t, n) { return Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }), e[t] } try { u({}, "") } catch (e) { u = function (e, t, n) { return e[t] = n } } function h(e, t, n, r) { var o = t && t.prototype instanceof p ? t : p, s = Object.create(o.prototype), a = new S(r || []); return i(s, "_invoke", { value: C(e, n, a) }), s } function f(e, t, n) { try { return { type: "normal", arg: e.call(t, n) } } catch (e) { return { type: "throw", arg: e } } } e.wrap = h; var l = {}; function p() { } function d() { } function y() { } var v = {}; u(v, s, (function () { return this })); var m = Object.getPrototypeOf, g = m && m(m(x([]))); g && g !== t && n.call(g, s) && (v = g); var E = y.prototype = p.prototype = Object.create(v); function b(e) { ["next", "throw", "return"].forEach((function (t) { u(e, t, (function (e) { return this._invoke(t, e) })) })) } function _(e, t) { function r(i, o, s, a) { var c = f(e[i], e, o); if ("throw" !== c.type) { var u = c.arg, h = u.value; return h && "object" == typeof h && n.call(h, "__await") ? t.resolve(h.__await).then((function (e) { r("next", e, s, a) }), (function (e) { r("throw", e, s, a) })) : t.resolve(h).then((function (e) { u.value = e, s(u) }), (function (e) { return r("throw", e, s, a) })) } a(c.arg) } var o; i(this, "_invoke", { value: function (e, n) { function i() { return new t((function (t, i) { r(e, n, t, i) })) } return o = o ? o.then(i, i) : i() } }) } function C(e, t, n) { var r = "suspendedStart"; return function (i, o) { if ("executing" === r) throw new Error("Generator is already running"); if ("completed" === r) { if ("throw" === i) throw o; return R() } for (n.method = i, n.arg = o; ;) { var s = n.delegate; if (s) { var a = k(s, n); if (a) { if (a === l) continue; return a } } if ("next" === n.method) n.sent = n._sent = n.arg; else if ("throw" === n.method) { if ("suspendedStart" === r) throw r = "completed", n.arg; n.dispatchException(n.arg) } else "return" === n.method && n.abrupt("return", n.arg); r = "executing"; var c = f(e, t, n); if ("normal" === c.type) { if (r = n.done ? "completed" : "suspendedYield", c.arg === l) continue; return { value: c.arg, done: n.done } } "throw" === c.type && (r = "completed", n.method = "throw", n.arg = c.arg) } } } function k(e, t) { var n = t.method, r = e.iterator[n]; if (void 0 === r) return t.delegate = null, "throw" === n && e.iterator.return && (t.method = "return", t.arg = void 0, k(e, t), "throw" === t.method) || "return" !== n && (t.method = "throw", t.arg = new TypeError("The iterator does not provide a '" + n + "' method")), l; var i = f(r, e.iterator, t.arg); if ("throw" === i.type) return t.method = "throw", t.arg = i.arg, t.delegate = null, l; var o = i.arg; return o ? o.done ? (t[e.resultName] = o.value, t.next = e.nextLoc, "return" !== t.method && (t.method = "next", t.arg = void 0), t.delegate = null, l) : o : (t.method = "throw", t.arg = new TypeError("iterator result is not an object"), t.delegate = null, l) } function A(e) { var t = { tryLoc: e[0] }; 1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t) } function w(e) { var t = e.completion || {}; t.type = "normal", delete t.arg, e.completion = t } function S(e) { this.tryEntries = [{ tryLoc: "root" }], e.forEach(A, this), this.reset(!0) } function x(e) { if (e) { var t = e[s]; if (t) return t.call(e); if ("function" == typeof e.next) return e; if (!isNaN(e.length)) { var r = -1, i = function t() { for (; ++r < e.length;)if (n.call(e, r)) return t.value = e[r], t.done = !1, t; return t.value = void 0, t.done = !0, t }; return i.next = i } } return { next: R } } function R() { return { value: void 0, done: !0 } } return d.prototype = y, i(E, "constructor", { value: y, configurable: !0 }), i(y, "constructor", { value: d, configurable: !0 }), d.displayName = u(y, c, "GeneratorFunction"), e.isGeneratorFunction = function (e) { var t = "function" == typeof e && e.constructor; return !!t && (t === d || "GeneratorFunction" === (t.displayName || t.name)) }, e.mark = function (e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, y) : (e.__proto__ = y, u(e, c, "GeneratorFunction")), e.prototype = Object.create(E), e }, e.awrap = function (e) { return { __await: e } }, b(_.prototype), u(_.prototype, a, (function () { return this })), e.AsyncIterator = _, e.async = function (t, n, r, i, o) { void 0 === o && (o = Promise); var s = new _(h(t, n, r, i), o); return e.isGeneratorFunction(n) ? s : s.next().then((function (e) { return e.done ? e.value : s.next() })) }, b(E), u(E, c, "Generator"), u(E, s, (function () { return this })), u(E, "toString", (function () { return "[object Generator]" })), e.keys = function (e) { var t = Object(e), n = []; for (var r in t) n.push(r); return n.reverse(), function e() { for (; n.length;) { var r = n.pop(); if (r in t) return e.value = r, e.done = !1, e } return e.done = !0, e } }, e.values = x, S.prototype = { constructor: S, reset: function (e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = !1, this.delegate = null, this.method = "next", this.arg = void 0, this.tryEntries.forEach(w), !e) for (var t in this) "t" === t.charAt(0) && n.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = void 0) }, stop: function () { this.done = !0; var e = this.tryEntries[0].completion; if ("throw" === e.type) throw e.arg; return this.rval }, dispatchException: function (e) { if (this.done) throw e; var t = this; function r(n, r) { return s.type = "throw", s.arg = e, t.next = n, r && (t.method = "next", t.arg = void 0), !!r } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var o = this.tryEntries[i], s = o.completion; if ("root" === o.tryLoc) return r("end"); if (o.tryLoc <= this.prev) { var a = n.call(o, "catchLoc"), c = n.call(o, "finallyLoc"); if (a && c) { if (this.prev < o.catchLoc) return r(o.catchLoc, !0); if (this.prev < o.finallyLoc) return r(o.finallyLoc) } else if (a) { if (this.prev < o.catchLoc) return r(o.catchLoc, !0) } else { if (!c) throw new Error("try statement without catch or finally"); if (this.prev < o.finallyLoc) return r(o.finallyLoc) } } } }, abrupt: function (e, t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var i = this.tryEntries[r]; if (i.tryLoc <= this.prev && n.call(i, "finallyLoc") && this.prev < i.finallyLoc) { var o = i; break } } o && ("break" === e || "continue" === e) && o.tryLoc <= t && t <= o.finallyLoc && (o = null); var s = o ? o.completion : {}; return s.type = e, s.arg = t, o ? (this.method = "next", this.next = o.finallyLoc, l) : this.complete(s) }, complete: function (e, t) { if ("throw" === e.type) throw e.arg; return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), l }, finish: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), w(n), l } }, catch: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.tryLoc === e) { var r = n.completion; if ("throw" === r.type) { var i = r.arg; w(n) } return i } } throw new Error("illegal catch attempt") }, delegateYield: function (e, t, n) { return this.delegate = { iterator: x(e), resultName: t, nextLoc: n }, "next" === this.method && (this.arg = void 0), l } }, e } function i(e) { return i = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }, i(e) } function o(e, t, n, r, i, o, s) { try { var a = e[o](s), c = a.value } catch (e) { return void n(e) } a.done ? t(c) : Promise.resolve(c).then(r, i) } function s(e) { return function () { var t = this, n = arguments; return new Promise((function (r, i) { var s = e.apply(t, n); function a(e) { o(s, r, i, a, c, "next", e) } function c(e) { o(s, r, i, a, c, "throw", e) } a(void 0) })) } } function a(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function c(e, t) { for (var n = 0; n < t.length; n++) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, k(r.key), r) } } function u(e, t, n) { return t && c(e.prototype, t), n && c(e, n), Object.defineProperty(e, "prototype", { writable: !1 }), e } function h(e, t, n) { return (t = k(t)) in e ? Object.defineProperty(e, t, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = n, e } function f() { return f = Object.assign ? Object.assign.bind() : function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }, f.apply(this, arguments) } function l(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), Object.defineProperty(e, "prototype", { writable: !1 }), t && d(e, t) } function p(e) { return p = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (e) { return e.__proto__ || Object.getPrototypeOf(e) }, p(e) } function d(e, t) { return d = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (e, t) { return e.__proto__ = t, e }, d(e, t) } function y() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function () { }))), !0 } catch (e) { return !1 } } function v(e, t, n) { return v = y() ? Reflect.construct.bind() : function (e, t, n) { var r = [null]; r.push.apply(r, t); var i = new (Function.bind.apply(e, r)); return n && d(i, n.prototype), i }, v.apply(null, arguments) } function m(e) { var t = "function" == typeof Map ? new Map : void 0; return m = function (e) { if (null === e || (n = e, -1 === Function.toString.call(n).indexOf("[native code]"))) return e; var n; if ("function" != typeof e) throw new TypeError("Super expression must either be null or a function"); if (void 0 !== t) { if (t.has(e)) return t.get(e); t.set(e, r) } function r() { return v(e, arguments, p(this).constructor) } return r.prototype = Object.create(e.prototype, { constructor: { value: r, enumerable: !1, writable: !0, configurable: !0 } }), d(r, e) }, m(e) } function g(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e } function E(e) { var t = y(); return function () { var n, r = p(e); if (t) { var i = p(this).constructor; n = Reflect.construct(r, arguments, i) } else n = r.apply(this, arguments); return function (e, t) { if (t && ("object" == typeof t || "function" == typeof t)) return t; if (void 0 !== t) throw new TypeError("Derived constructors may only return object or undefined"); return g(e) }(this, n) } } function b() { return b = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function (e, t, n) { var r = function (e, t) { for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = p(e));); return e }(e, t); if (r) { var i = Object.getOwnPropertyDescriptor(r, t); return i.get ? i.get.call(arguments.length < 3 ? e : n) : i.value } }, b.apply(this, arguments) } function _(e, t) { (null == t || t > e.length) && (t = e.length); for (var n = 0, r = new Array(t); n < t; n++)r[n] = e[n]; return r } function C(e, t) { var n = "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"]; if (!n) { if (Array.isArray(e) || (n = function (e, t) { if (e) { if ("string" == typeof e) return _(e, t); var n = Object.prototype.toString.call(e).slice(8, -1); return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? _(e, t) : void 0 } }(e)) || t && e && "number" == typeof e.length) { n && (e = n); var r = 0, i = function () { }; return { s: i, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function (e) { throw e }, f: i } } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") } var o, s = !0, a = !1; return { s: function () { n = n.call(e) }, n: function () { var e = n.next(); return s = e.done, e }, e: function (e) { a = !0, o = e }, f: function () { try { s || null == n.return || n.return() } finally { if (a) throw o } } } } function k(e) { var t = function (e, t) { if ("object" != typeof e || null === e) return e; var n = e[Symbol.toPrimitive]; if (void 0 !== n) { var r = n.call(e, t || "default"); if ("object" != typeof r) return r; throw new TypeError("@@toPrimitive must return a primitive value.") } return ("string" === t ? String : Number)(e) }(e, "string"); return "symbol" == typeof t ? t : String(t) } var A, w, S, x, R, O, T; !function (e) { e.ACTIVE = "ACTIVE", e.DEACTIVE = "DEACTIVE" }(A || (A = {})), function (e) { e.FREE = "FREE", e.PRODUCTION = "PRODUCTION", e.ADVANCED = "ADVANCED", e.ENTERPRISE = "ENTERPRISE" }(w || (w = {})), function (e) { e.PRODUCTION = "PRODUCTION", e.ADVANCED = "ADVANCED", e.ENTERPRISE = "ENTERPRISE" }(S || (S = {})), function (e) { e.OWNER = "OWNER", e.DEVELOPER = "DEVELOPER", e.MANAGER = "MANAGER" }(x || (x = {})), function (e) { e.SUPER = "SUPER", e.WRITE = "WRITE", e.READ = "READ" }(R || (R = {})), function (e) { e.TEXT = "TEXT", e.FILE = "FILE", e.JSON = "JSON" }(O || (O = {})), function (e) { e.USER = "USER", e.ADMIN = "ADMIN", e.SYSTEM = "SYSTEM" }(T || (T = {})); var N, M, L = ["image/png", "image/jpg", "image/jpeg", "image/gif", "image/webp"], D = ["video/mp4", "video/webm"]; !function (e) { e.CHATTY_USER_MESSAGE = "CHATTY_USER_MESSAGE", e.CHATTY_ADMIN_MESSAGE = "CHATTY_ADMIN_MESSAGE", e.CHATTY_SYSTEM_MESSAGE = "CHATTY_SYSTEM_MESSAGE" }(N || (N = {})), function (e) { e.CONNECT = "connection", e.CONNECT_DONE = "connect_done", e.CONNECT_FAIL = "connect_fail", e.DISCONNECT = "disconnect", e.DISCONNECT_DONE = "disconnect_done", e.DISCONNECT_FAIL = "disconnect_fail", e.REFRESH_CHAT = "refresh_chat", e.REFRESH_CHAT_DONE = "refresh_chat_done", e.REFRESH_CHAT_FAIL = "refresh_chat_fail", e.RECEIVE_MESSAGE = "receive_message", e.FETCH_MESSAGES = "fetch_messages", e.FETCH_MESSAGES_DONE = "fetch_messages_done", e.FETCH_MESSAGES_FAIL = "fetch_messages_fail", e.UPDATE_MESSAGES = "update_message", e.FETCH_CHATS = "fetch_chats", e.FETCH_CHATS_DONE = "fetch_chats_done", e.FETCH_CHATS_FAIL = "fetch_chats_fail", e.SEND_MESSAGE = "send_message", e.SEND_MESSAGE_DONE = "send_message_done", e.SEND_MESSAGE_FAIL = "send_message_fail", e.SEND_MESSAGE_RETRY = "send_message_retry", e.DELETE_MESSAGE = "delete_message", e.DELETE_MESSAGE_DONE = "delete_message_done", e.DELETE_MESSAGE_FAIL = "delete_message_fail", e.MARK_AS_READ = "mark_as_read", e.MARK_AS_READ_DONE = "mark_as_read_done", e.MARK_AS_READ_FAIL = "mark_as_read_fail", e.MARK_AS_READ_BYPASS = "mark_as_read_bypass", e.INVITE_MEMBERS = "invite_members", e.INVITE_MEMBERS_DONE = "invite_members_done", e.INVITE_MEMBERS_FAIL = "invite_members_fail", e.EXCLUDE_MEMBERS = "exclude_members", e.EXCLUDE_MEMBERS_DONE = "exclude_members_done", e.EXCLUDE_MEMBERS_FAIL = "exclude_members_fail", e.JOIN_CHAT = "join_chat", e.JOIN_CHAT_DONE = "join_chat_done", e.JOIN_CHAT_FAIL = "join_chat_fail", e.LEAVE_CHAT = "leave_chat", e.LEAVE_CHAT_DONE = "leave_chat_done", e.LEAVE_CHAT_FAIL = "leave_chat_fail" }(M || (M = {})); var I = Object.freeze({ __proto__: null, get eAppState() { return A }, get eAppPricing() { return w }, get eSubscriptionPlan() { return S }, get eAppUserRole() { return x }, get eMemberPermission() { return R }, get eMessageType() { return O }, get eMessageBy() { return T }, SupportedImageFormat: L, SupportedVideoFormat: D, SupportedUploadSize: 2e7, get eChattyNotification() { return N }, get eChattyEvent() { return M } }); function P(e) { return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e } var j = {}, F = { get exports() { return j }, set exports(e) { j = e } }, B = {}, U = { get exports() { return B }, set exports(e) { B = e } }, H = function (e, t) { return function () { for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; return e.apply(t, n) } }, q = H, V = Object.prototype.toString, G = function (e) { return function (t) { var n = V.call(t); return e[n] || (e[n] = n.slice(8, -1).toLowerCase()) } }(Object.create(null)); function K(e) { return e = e.toLowerCase(), function (t) { return G(t) === e } } function Y(e) { return Array.isArray(e) } function z(e) { return void 0 === e } var J = K("ArrayBuffer"); function W(e) { return null !== e && "object" === i(e) } function X(e) { if ("object" !== G(e)) return !1; var t = Object.getPrototypeOf(e); return null === t || t === Object.prototype } var $ = K("Date"), Q = K("File"), Z = K("Blob"), ee = K("FileList"); function te(e) { return "[object Function]" === V.call(e) } var ne = K("URLSearchParams"); function re(e, t) { if (null != e) if ("object" !== i(e) && (e = [e]), Y(e)) for (var n = 0, r = e.length; n < r; n++)t.call(null, e[n], n, e); else for (var o in e) Object.prototype.hasOwnProperty.call(e, o) && t.call(null, e[o], o, e) } var ie, oe = (ie = "undefined" != typeof Uint8Array && Object.getPrototypeOf(Uint8Array), function (e) { return ie && e instanceof ie }), se = { isArray: Y, isArrayBuffer: J, isBuffer: function (e) { return null !== e && !z(e) && null !== e.constructor && !z(e.constructor) && "function" == typeof e.constructor.isBuffer && e.constructor.isBuffer(e) }, isFormData: function (e) { var t = "[object FormData]"; return e && ("function" == typeof FormData && e instanceof FormData || V.call(e) === t || te(e.toString) && e.toString() === t) }, isArrayBufferView: function (e) { return "undefined" != typeof ArrayBuffer && ArrayBuffer.isView ? ArrayBuffer.isView(e) : e && e.buffer && J(e.buffer) }, isString: function (e) { return "string" == typeof e }, isNumber: function (e) { return "number" == typeof e }, isObject: W, isPlainObject: X, isUndefined: z, isDate: $, isFile: Q, isBlob: Z, isFunction: te, isStream: function (e) { return W(e) && te(e.pipe) }, isURLSearchParams: ne, isStandardBrowserEnv: function () { return ("undefined" == typeof navigator || "ReactNative" !== navigator.product && "NativeScript" !== navigator.product && "NS" !== navigator.product) && ("undefined" != typeof window && "undefined" != typeof document) }, forEach: re, merge: function e() { var t = {}; function n(n, r) { X(t[r]) && X(n) ? t[r] = e(t[r], n) : X(n) ? t[r] = e({}, n) : Y(n) ? t[r] = n.slice() : t[r] = n } for (var r = 0, i = arguments.length; r < i; r++)re(arguments[r], n); return t }, extend: function (e, t, n) { return re(t, (function (t, r) { e[r] = n && "function" == typeof t ? q(t, n) : t })), e }, trim: function (e) { return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "") }, stripBOM: function (e) { return 65279 === e.charCodeAt(0) && (e = e.slice(1)), e }, inherits: function (e, t, n, r) { e.prototype = Object.create(t.prototype, r), e.prototype.constructor = e, n && f(e.prototype, n) }, toFlatObject: function (e, t, n) { var r, i, o, s = {}; t = t || {}; do { for (i = (r = Object.getOwnPropertyNames(e)).length; i-- > 0;)s[o = r[i]] || (t[o] = e[o], s[o] = !0); e = Object.getPrototypeOf(e) } while (e && (!n || n(e, t)) && e !== Object.prototype); return t }, kindOf: G, kindOfTest: K, endsWith: function (e, t, n) { e = String(e), (void 0 === n || n > e.length) && (n = e.length), n -= t.length; var r = e.indexOf(t, n); return -1 !== r && r === n }, toArray: function (e) { if (!e) return null; var t = e.length; if (z(t)) return null; for (var n = new Array(t); t-- > 0;)n[t] = e[t]; return n }, isTypedArray: oe, isFileList: ee }, ae = se; function ce(e) { return encodeURIComponent(e).replace(/%3A/gi, ":").replace(/%24/g, "$").replace(/%2C/gi, ",").replace(/%20/g, "+").replace(/%5B/gi, "[").replace(/%5D/gi, "]") } var ue = function (e, t, n) { if (!t) return e; var r; if (n) r = n(t); else if (ae.isURLSearchParams(t)) r = t.toString(); else { var i = []; ae.forEach(t, (function (e, t) { null != e && (ae.isArray(e) ? t += "[]" : e = [e], ae.forEach(e, (function (e) { ae.isDate(e) ? e = e.toISOString() : ae.isObject(e) && (e = JSON.stringify(e)), i.push(ce(t) + "=" + ce(e)) }))) })), r = i.join("&") } if (r) { var o = e.indexOf("#"); -1 !== o && (e = e.slice(0, o)), e += (-1 === e.indexOf("?") ? "?" : "&") + r } return e }, he = se; function fe() { this.handlers = [] } fe.prototype.use = function (e, t, n) { return this.handlers.push({ fulfilled: e, rejected: t, synchronous: !!n && n.synchronous, runWhen: n ? n.runWhen : null }), this.handlers.length - 1 }, fe.prototype.eject = function (e) { this.handlers[e] && (this.handlers[e] = null) }, fe.prototype.forEach = function (e) { he.forEach(this.handlers, (function (t) { null !== t && e(t) })) }; var le, pe, de = fe, ye = se; function ve() { if (pe) return le; pe = 1; var e = se; function t(e, t, n, r, i) { Error.call(this), this.message = e, this.name = "AxiosError", t && (this.code = t), n && (this.config = n), r && (this.request = r), i && (this.response = i) } e.inherits(t, Error, { toJSON: function () { return { message: this.message, name: this.name, description: this.description, number: this.number, fileName: this.fileName, lineNumber: this.lineNumber, columnNumber: this.columnNumber, stack: this.stack, config: this.config, code: this.code, status: this.response && this.response.status ? this.response.status : null } } }); var n = t.prototype, r = {}; return ["ERR_BAD_OPTION_VALUE", "ERR_BAD_OPTION", "ECONNABORTED", "ETIMEDOUT", "ERR_NETWORK", "ERR_FR_TOO_MANY_REDIRECTS", "ERR_DEPRECATED", "ERR_BAD_RESPONSE", "ERR_BAD_REQUEST", "ERR_CANCELED"].forEach((function (e) { r[e] = { value: e } })), Object.defineProperties(t, r), Object.defineProperty(n, "isAxiosError", { value: !0 }), t.from = function (r, i, o, s, a, c) { var u = Object.create(n); return e.toFlatObject(r, u, (function (e) { return e !== Error.prototype })), t.call(u, r.message, i, o, s, a), u.name = r.name, c && f(u, c), u }, le = t } var me, ge, Ee, be, _e, Ce, ke = { silentJSONParsing: !0, forcedJSONParsing: !0, clarifyTimeoutError: !1 }; function Ae() { if (ge) return me; ge = 1; var e = se; return me = function (t, n) { n = n || new FormData; var r = []; function o(t) { return null === t ? "" : e.isDate(t) ? t.toISOString() : e.isArrayBuffer(t) || e.isTypedArray(t) ? "function" == typeof Blob ? new Blob([t]) : Buffer.from(t) : t } return function t(s, a) { if (e.isPlainObject(s) || e.isArray(s)) { if (-1 !== r.indexOf(s)) throw Error("Circular reference detected in " + a); r.push(s), e.forEach(s, (function (r, s) { if (!e.isUndefined(r)) { var c, u = a ? a + "." + s : s; if (r && !a && "object" === i(r)) if (e.endsWith(s, "{}")) r = JSON.stringify(r); else if (e.endsWith(s, "[]") && (c = e.toArray(r))) return void c.forEach((function (t) { !e.isUndefined(t) && n.append(u, o(t)) })); t(r, u) } })), r.pop() } else n.append(a, o(s)) }(t), n }, me } function we() { if (be) return Ee; be = 1; var e = ve(); return Ee = function (t, n, r) { var i = r.config.validateStatus; r.status && i && !i(r.status) ? n(new e("Request failed with status code " + r.status, [e.ERR_BAD_REQUEST, e.ERR_BAD_RESPONSE][Math.floor(r.status / 100) - 4], r.config, r.request, r)) : t(r) } } function Se() { if (Ce) return _e; Ce = 1; var e = se; return _e = e.isStandardBrowserEnv() ? { write: function (t, n, r, i, o, s) { var a = []; a.push(t + "=" + encodeURIComponent(n)), e.isNumber(r) && a.push("expires=" + new Date(r).toGMTString()), e.isString(i) && a.push("path=" + i), e.isString(o) && a.push("domain=" + o), !0 === s && a.push("secure"), document.cookie = a.join("; ") }, read: function (e) { var t = document.cookie.match(new RegExp("(^|;\\s*)(" + e + ")=([^;]*)")); return t ? decodeURIComponent(t[3]) : null }, remove: function (e) { this.write(e, "", Date.now() - 864e5) } } : { write: function () { }, read: function () { return null }, remove: function () { } }, _e } var xe, Re, Oe, Te, Ne, Me, Le, De, Ie, Pe, je, Fe, Be = function (e) { return /^([a-z][a-z\d+\-.]*:)?\/\//i.test(e) }, Ue = function (e, t) { return t ? e.replace(/\/+$/, "") + "/" + t.replace(/^\/+/, "") : e }, He = function (e, t) { return e && !Be(t) ? Ue(e, t) : t }; function qe() { if (Re) return xe; Re = 1; var e = se, t = ["age", "authorization", "content-length", "content-type", "etag", "expires", "from", "host", "if-modified-since", "if-unmodified-since", "last-modified", "location", "max-forwards", "proxy-authorization", "referer", "retry-after", "user-agent"]; return xe = function (n) { var r, i, o, s = {}; return n ? (e.forEach(n.split("\n"), (function (n) { if (o = n.indexOf(":"), r = e.trim(n.substr(0, o)).toLowerCase(), i = e.trim(n.substr(o + 1)), r) { if (s[r] && t.indexOf(r) >= 0) return; s[r] = "set-cookie" === r ? (s[r] ? s[r] : []).concat([i]) : s[r] ? s[r] + ", " + i : i } })), s) : s }, xe } function Ve() { if (Te) return Oe; Te = 1; var e = se; return Oe = e.isStandardBrowserEnv() ? function () { var t, n = /(msie|trident)/i.test(navigator.userAgent), r = document.createElement("a"); function i(e) { var t = e; return n && (r.setAttribute("href", t), t = r.href), r.setAttribute("href", t), { href: r.href, protocol: r.protocol ? r.protocol.replace(/:$/, "") : "", host: r.host, search: r.search ? r.search.replace(/^\?/, "") : "", hash: r.hash ? r.hash.replace(/^#/, "") : "", hostname: r.hostname, port: r.port, pathname: "/" === r.pathname.charAt(0) ? r.pathname : "/" + r.pathname } } return t = i(window.location.href), function (n) { var r = e.isString(n) ? i(n) : n; return r.protocol === t.protocol && r.host === t.host } }() : function () { return !0 }, Oe } function Ge() { if (Me) return Ne; Me = 1; var e = ve(); function t(t) { e.call(this, null == t ? "canceled" : t, e.ERR_CANCELED), this.name = "CanceledError" } return se.inherits(t, e, { __CANCEL__: !0 }), Ne = t } function Ke() { return De || (De = 1, Le = function (e) { var t = /^([-+\w]{1,25})(:?\/\/|:)/.exec(e); return t && t[1] || "" }), Le } function Ye() { if (Pe) return Ie; Pe = 1; var e = se, t = we(), n = Se(), r = ue, i = He, o = qe(), s = Ve(), a = ke, c = ve(), u = Ge(), h = Ke(); return Ie = function (f) { return new Promise((function (l, p) { var d, y = f.data, v = f.headers, m = f.responseType; function g() { f.cancelToken && f.cancelToken.unsubscribe(d), f.signal && f.signal.removeEventListener("abort", d) } e.isFormData(y) && e.isStandardBrowserEnv() && delete v["Content-Type"]; var E = new XMLHttpRequest; if (f.auth) { var b = f.auth.username || "", _ = f.auth.password ? unescape(encodeURIComponent(f.auth.password)) : ""; v.Authorization = "Basic " + btoa(b + ":" + _) } var C = i(f.baseURL, f.url); function k() { if (E) { var e = "getAllResponseHeaders" in E ? o(E.getAllResponseHeaders()) : null, n = { data: m && "text" !== m && "json" !== m ? E.response : E.responseText, status: E.status, statusText: E.statusText, headers: e, config: f, request: E }; t((function (e) { l(e), g() }), (function (e) { p(e), g() }), n), E = null } } if (E.open(f.method.toUpperCase(), r(C, f.params, f.paramsSerializer), !0), E.timeout = f.timeout, "onloadend" in E ? E.onloadend = k : E.onreadystatechange = function () { E && 4 === E.readyState && (0 !== E.status || E.responseURL && 0 === E.responseURL.indexOf("file:")) && setTimeout(k) }, E.onabort = function () { E && (p(new c("Request aborted", c.ECONNABORTED, f, E)), E = null) }, E.onerror = function () { p(new c("Network Error", c.ERR_NETWORK, f, E, E)), E = null }, E.ontimeout = function () { var e = f.timeout ? "timeout of " + f.timeout + "ms exceeded" : "timeout exceeded", t = f.transitional || a; f.timeoutErrorMessage && (e = f.timeoutErrorMessage), p(new c(e, t.clarifyTimeoutError ? c.ETIMEDOUT : c.ECONNABORTED, f, E)), E = null }, e.isStandardBrowserEnv()) { var A = (f.withCredentials || s(C)) && f.xsrfCookieName ? n.read(f.xsrfCookieName) : void 0; A && (v[f.xsrfHeaderName] = A) } "setRequestHeader" in E && e.forEach(v, (function (e, t) { void 0 === y && "content-type" === t.toLowerCase() ? delete v[t] : E.setRequestHeader(t, e) })), e.isUndefined(f.withCredentials) || (E.withCredentials = !!f.withCredentials), m && "json" !== m && (E.responseType = f.responseType), "function" == typeof f.onDownloadProgress && E.addEventListener("progress", f.onDownloadProgress), "function" == typeof f.onUploadProgress && E.upload && E.upload.addEventListener("progress", f.onUploadProgress), (f.cancelToken || f.signal) && (d = function (e) { E && (p(!e || e && e.type ? new u : e), E.abort(), E = null) }, f.cancelToken && f.cancelToken.subscribe(d), f.signal && (f.signal.aborted ? d() : f.signal.addEventListener("abort", d))), y || (y = null); var w = h(C); w && -1 === ["http", "https", "file"].indexOf(w) ? p(new c("Unsupported protocol " + w + ":", c.ERR_BAD_REQUEST, f)) : E.send(y) })) }, Ie } var ze = se, Je = function (e, t) { ye.forEach(e, (function (n, r) { r !== t && r.toUpperCase() === t.toUpperCase() && (e[t] = n, delete e[r]) })) }, We = ve(), Xe = ke, $e = Ae(), Qe = { "Content-Type": "application/x-www-form-urlencoded" }; function Ze(e, t) { !ze.isUndefined(e) && ze.isUndefined(e["Content-Type"]) && (e["Content-Type"] = t) } var et, tt = { transitional: Xe, adapter: (("undefined" != typeof XMLHttpRequest || "undefined" != typeof process && "[object process]" === Object.prototype.toString.call(process)) && (et = Ye()), et), transformRequest: [function (e, t) { if (Je(t, "Accept"), Je(t, "Content-Type"), ze.isFormData(e) || ze.isArrayBuffer(e) || ze.isBuffer(e) || ze.isStream(e) || ze.isFile(e) || ze.isBlob(e)) return e; if (ze.isArrayBufferView(e)) return e.buffer; if (ze.isURLSearchParams(e)) return Ze(t, "application/x-www-form-urlencoded;charset=utf-8"), e.toString(); var n, r = ze.isObject(e), i = t && t["Content-Type"]; if ((n = ze.isFileList(e)) || r && "multipart/form-data" === i) { var o = this.env && this.env.FormData; return $e(n ? { "files[]": e } : e, o && new o) } return r || "application/json" === i ? (Ze(t, "application/json"), function (e, t, n) { if (ze.isString(e)) try { return (t || JSON.parse)(e), ze.trim(e) } catch (e) { if ("SyntaxError" !== e.name) throw e } return (n || JSON.stringify)(e) }(e)) : e }], transformResponse: [function (e) { var t = this.transitional || tt.transitional, n = t && t.silentJSONParsing, r = t && t.forcedJSONParsing, i = !n && "json" === this.responseType; if (i || r && ze.isString(e) && e.length) try { return JSON.parse(e) } catch (e) { if (i) { if ("SyntaxError" === e.name) throw We.from(e, We.ERR_BAD_RESPONSE, this, null, this.response); throw e } } return e }], timeout: 0, xsrfCookieName: "XSRF-TOKEN", xsrfHeaderName: "X-XSRF-TOKEN", maxContentLength: -1, maxBodyLength: -1, env: { FormData: Fe ? je : (Fe = 1, je = null) }, validateStatus: function (e) { return e >= 200 && e < 300 }, headers: { common: { Accept: "application/json, text/plain, */*" } } }; ze.forEach(["delete", "get", "head"], (function (e) { tt.headers[e] = {} })), ze.forEach(["post", "put", "patch"], (function (e) { tt.headers[e] = ze.merge(Qe) })); var nt, rt, it = tt, ot = se, st = it; function at() { return rt || (rt = 1, nt = function (e) { return !(!e || !e.__CANCEL__) }), nt } var ct = se, ut = function (e, t, n) { var r = this || st; return ot.forEach(n, (function (n) { e = n.call(r, e, t) })), e }, ht = at(), ft = it, lt = Ge(); function pt(e) { if (e.cancelToken && e.cancelToken.throwIfRequested(), e.signal && e.signal.aborted) throw new lt } var dt, yt, vt = se, mt = function (e, t) { t = t || {}; var n = {}; function r(e, t) { return vt.isPlainObject(e) && vt.isPlainObject(t) ? vt.merge(e, t) : vt.isPlainObject(t) ? vt.merge({}, t) : vt.isArray(t) ? t.slice() : t } function i(n) { return vt.isUndefined(t[n]) ? vt.isUndefined(e[n]) ? void 0 : r(void 0, e[n]) : r(e[n], t[n]) } function o(e) { if (!vt.isUndefined(t[e])) return r(void 0, t[e]) } function s(n) { return vt.isUndefined(t[n]) ? vt.isUndefined(e[n]) ? void 0 : r(void 0, e[n]) : r(void 0, t[n]) } function a(n) { return n in t ? r(e[n], t[n]) : n in e ? r(void 0, e[n]) : void 0 } var c = { url: o, method: o, data: o, baseURL: s, transformRequest: s, transformResponse: s, paramsSerializer: s, timeout: s, timeoutMessage: s, withCredentials: s, adapter: s, responseType: s, xsrfCookieName: s, xsrfHeaderName: s, onUploadProgress: s, onDownloadProgress: s, decompress: s, maxContentLength: s, maxBodyLength: s, beforeRedirect: s, transport: s, httpAgent: s, httpsAgent: s, cancelToken: s, socketPath: s, responseEncoding: s, validateStatus: a }; return vt.forEach(Object.keys(e).concat(Object.keys(t)), (function (e) { var t = c[e] || i, r = t(e); vt.isUndefined(r) && t !== a || (n[e] = r) })), n }; function gt() { return yt ? dt : (yt = 1, dt = { version: "0.27.2" }) } var Et = gt().version, bt = ve(), _t = {};["object", "boolean", "number", "function", "string", "symbol"].forEach((function (e, t) { _t[e] = function (n) { return i(n) === e || "a" + (t < 1 ? "n " : " ") + e } })); var Ct = {}; _t.transitional = function (e, t, n) { function r(e, t) { return "[Axios v" + Et + "] Transitional option '" + e + "'" + t + (n ? ". " + n : "") } return function (n, i, o) { if (!1 === e) throw new bt(r(i, " has been removed" + (t ? " in " + t : "")), bt.ERR_DEPRECATED); return t && !Ct[i] && (Ct[i] = !0, console.warn(r(i, " has been deprecated since v" + t + " and will be removed in the near future"))), !e || e(n, i, o) } }; var kt, At, wt, St, xt, Rt, Ot = { assertOptions: function (e, t, n) { if ("object" !== i(e)) throw new bt("options must be an object", bt.ERR_BAD_OPTION_VALUE); for (var r = Object.keys(e), o = r.length; o-- > 0;) { var s = r[o], a = t[s]; if (a) { var c = e[s], u = void 0 === c || a(c, s, e); if (!0 !== u) throw new bt("option " + s + " must be " + u, bt.ERR_BAD_OPTION_VALUE) } else if (!0 !== n) throw new bt("Unknown option " + s, bt.ERR_BAD_OPTION) } }, validators: _t }, Tt = se, Nt = ue, Mt = de, Lt = function (e) { return pt(e), e.headers = e.headers || {}, e.data = ut.call(e, e.data, e.headers, e.transformRequest), e.headers = ct.merge(e.headers.common || {}, e.headers[e.method] || {}, e.headers), ct.forEach(["delete", "get", "head", "post", "put", "patch", "common"], (function (t) { delete e.headers[t] })), (e.adapter || ft.adapter)(e).then((function (t) { return pt(e), t.data = ut.call(e, t.data, t.headers, e.transformResponse), t }), (function (t) { return ht(t) || (pt(e), t && t.response && (t.response.data = ut.call(e, t.response.data, t.response.headers, e.transformResponse))), Promise.reject(t) })) }, Dt = mt, It = He, Pt = Ot, jt = Pt.validators; function Ft(e) { this.defaults = e, this.interceptors = { request: new Mt, response: new Mt } } Ft.prototype.request = function (e, t) { "string" == typeof e ? (t = t || {}).url = e : t = e || {}, (t = Dt(this.defaults, t)).method ? t.method = t.method.toLowerCase() : this.defaults.method ? t.method = this.defaults.method.toLowerCase() : t.method = "get"; var n = t.transitional; void 0 !== n && Pt.assertOptions(n, { silentJSONParsing: jt.transitional(jt.boolean), forcedJSONParsing: jt.transitional(jt.boolean), clarifyTimeoutError: jt.transitional(jt.boolean) }, !1); var r = [], i = !0; this.interceptors.request.forEach((function (e) { "function" == typeof e.runWhen && !1 === e.runWhen(t) || (i = i && e.synchronous, r.unshift(e.fulfilled, e.rejected)) })); var o, s = []; if (this.interceptors.response.forEach((function (e) { s.push(e.fulfilled, e.rejected) })), !i) { var a = [Lt, void 0]; for (Array.prototype.unshift.apply(a, r), a = a.concat(s), o = Promise.resolve(t); a.length;)o = o.then(a.shift(), a.shift()); return o } for (var c = t; r.length;) { var u = r.shift(), h = r.shift(); try { c = u(c) } catch (e) { h(e); break } } try { o = Lt(c) } catch (e) { return Promise.reject(e) } for (; s.length;)o = o.then(s.shift(), s.shift()); return o }, Ft.prototype.getUri = function (e) { e = Dt(this.defaults, e); var t = It(e.baseURL, e.url); return Nt(t, e.params, e.paramsSerializer) }, Tt.forEach(["delete", "get", "head", "options"], (function (e) { Ft.prototype[e] = function (t, n) { return this.request(Dt(n || {}, { method: e, url: t, data: (n || {}).data })) } })), Tt.forEach(["post", "put", "patch"], (function (e) { function t(t) { return function (n, r, i) { return this.request(Dt(i || {}, { method: e, headers: t ? { "Content-Type": "multipart/form-data" } : {}, url: n, data: r })) } } Ft.prototype[e] = t(), Ft.prototype[e + "Form"] = t(!0) })); var Bt = se, Ut = H, Ht = Ft, qt = mt; var Vt = function e(t) { var n = new Ht(t), r = Ut(Ht.prototype.request, n); return Bt.extend(r, Ht.prototype, n), Bt.extend(r, n), r.create = function (n) { return e(qt(t, n)) }, r }(it); Vt.Axios = Ht, Vt.CanceledError = Ge(), Vt.CancelToken = function () { if (At) return kt; At = 1; var e = Ge(); function t(t) { if ("function" != typeof t) throw new TypeError("executor must be a function."); var n; this.promise = new Promise((function (e) { n = e })); var r = this; this.promise.then((function (e) { if (r._listeners) { var t, n = r._listeners.length; for (t = 0; t < n; t++)r._listeners[t](e); r._listeners = null } })), this.promise.then = function (e) { var t, n = new Promise((function (e) { r.subscribe(e), t = e })).then(e); return n.cancel = function () { r.unsubscribe(t) }, n }, t((function (t) { r.reason || (r.reason = new e(t), n(r.reason)) })) } return t.prototype.throwIfRequested = function () { if (this.reason) throw this.reason }, t.prototype.subscribe = function (e) { this.reason ? e(this.reason) : this._listeners ? this._listeners.push(e) : this._listeners = [e] }, t.prototype.unsubscribe = function (e) { if (this._listeners) { var t = this._listeners.indexOf(e); -1 !== t && this._listeners.splice(t, 1) } }, t.source = function () { var e; return { token: new t((function (t) { e = t })), cancel: e } }, kt = t }(), Vt.isCancel = at(), Vt.VERSION = gt().version, Vt.toFormData = Ae(), Vt.AxiosError = ve(), Vt.Cancel = Vt.CanceledError, Vt.all = function (e) { return Promise.all(e) }, Vt.spread = St ? wt : (St = 1, wt = function (e) { return function (t) { return e.apply(null, t) } }), Vt.isAxiosError = function () { if (Rt) return xt; Rt = 1; var e = se; return xt = function (t) { return e.isObject(t) && !0 === t.isAxiosError } }(), U.exports = Vt, B.default = Vt, function (e) { e.exports = B }(F); var Gt = P(j), Kt = Object.create(null); Kt.open = "0", Kt.close = "1", Kt.ping = "2", Kt.pong = "3", Kt.message = "4", Kt.upgrade = "5", Kt.noop = "6"; var Yt = Object.create(null); Object.keys(Kt).forEach((function (e) { Yt[Kt[e]] = e })); for (var zt = { type: "error", data: "parser error" }, Jt = "function" == typeof Blob || "undefined" != typeof Blob && "[object BlobConstructor]" === Object.prototype.toString.call(Blob), Wt = "function" == typeof ArrayBuffer, Xt = function (e, t, n) { var r, i = e.type, o = e.data; return Jt && o instanceof Blob ? t ? n(o) : $t(o, n) : Wt && (o instanceof ArrayBuffer || (r = o, "function" == typeof ArrayBuffer.isView ? ArrayBuffer.isView(r) : r && r.buffer instanceof ArrayBuffer)) ? t ? n(o) : $t(new Blob([o]), n) : n(Kt[i] + (o || "")) }, $t = function (e, t) { var n = new FileReader; return n.onload = function () { var e = n.result.split(",")[1]; t("b" + (e || "")) }, n.readAsDataURL(e) }, Qt = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", Zt = "undefined" == typeof Uint8Array ? [] : new Uint8Array(256), en = 0; en < Qt.length; en++)Zt[Qt.charCodeAt(en)] = en; var tn = "function" == typeof ArrayBuffer, nn = function (e, t) { if ("string" != typeof e) return { type: "message", data: on(e, t) }; var n = e.charAt(0); return "b" === n ? { type: "message", data: rn(e.substring(1), t) } : Yt[n] ? e.length > 1 ? { type: Yt[n], data: e.substring(1) } : { type: Yt[n] } : zt }, rn = function (e, t) { if (tn) { var n = function (e) { var t, n, r, i, o, s = .75 * e.length, a = e.length, c = 0; "=" === e[e.length - 1] && (s--, "=" === e[e.length - 2] && s--); var u = new ArrayBuffer(s), h = new Uint8Array(u); for (t = 0; t < a; t += 4)n = Zt[e.charCodeAt(t)], r = Zt[e.charCodeAt(t + 1)], i = Zt[e.charCodeAt(t + 2)], o = Zt[e.charCodeAt(t + 3)], h[c++] = n << 2 | r >> 4, h[c++] = (15 & r) << 4 | i >> 2, h[c++] = (3 & i) << 6 | 63 & o; return u }(e); return on(n, t) } return { base64: !0, data: e } }, on = function (e, t) { return "blob" === t && e instanceof ArrayBuffer ? new Blob([e]) : e }, sn = String.fromCharCode(30); function an(e) { if (e) return function (e) { for (var t in an.prototype) e[t] = an.prototype[t]; return e }(e) } an.prototype.on = an.prototype.addEventListener = function (e, t) { return this._callbacks = this._callbacks || {}, (this._callbacks["$" + e] = this._callbacks["$" + e] || []).push(t), this }, an.prototype.once = function (e, t) { function n() { this.off(e, n), t.apply(this, arguments) } return n.fn = t, this.on(e, n), this }, an.prototype.off = an.prototype.removeListener = an.prototype.removeAllListeners = an.prototype.removeEventListener = function (e, t) { if (this._callbacks = this._callbacks || {}, 0 == arguments.length) return this._callbacks = {}, this; var n, r = this._callbacks["$" + e]; if (!r) return this; if (1 == arguments.length) return delete this._callbacks["$" + e], this; for (var i = 0; i < r.length; i++)if ((n = r[i]) === t || n.fn === t) { r.splice(i, 1); break } return 0 === r.length && delete this._callbacks["$" + e], this }, an.prototype.emit = function (e) { this._callbacks = this._callbacks || {}; for (var t = new Array(arguments.length - 1), n = this._callbacks["$" + e], r = 1; r < arguments.length; r++)t[r - 1] = arguments[r]; if (n) { r = 0; for (var i = (n = n.slice(0)).length; r < i; ++r)n[r].apply(this, t) } return this }, an.prototype.emitReserved = an.prototype.emit, an.prototype.listeners = function (e) { return this._callbacks = this._callbacks || {}, this._callbacks["$" + e] || [] }, an.prototype.hasListeners = function (e) { return !!this.listeners(e).length }; var cn = "undefined" != typeof self ? self : "undefined" != typeof window ? window : Function("return this")(); function un(e) { for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++)n[r - 1] = arguments[r]; return n.reduce((function (t, n) { return e.hasOwnProperty(n) && (t[n] = e[n]), t }), {}) } var hn = cn.setTimeout, fn = cn.clearTimeout; function ln(e, t) { t.useNativeTimers ? (e.setTimeoutFn = hn.bind(cn), e.clearTimeoutFn = fn.bind(cn)) : (e.setTimeoutFn = cn.setTimeout.bind(cn), e.clearTimeoutFn = cn.clearTimeout.bind(cn)) } var pn = 1.33; var dn, yn = function (e) { l(n, e); var t = E(n); function n(e, r, i) { var o; return a(this, n), (o = t.call(this, e)).description = r, o.context = i, o.type = "TransportError", o } return u(n) }(m(Error)), vn = function (e) { l(n, e); var t = E(n); function n(e) { var r; return a(this, n), (r = t.call(this)).writable = !1, ln(g(r), e), r.opts = e, r.query = e.query, r.socket = e.socket, r } return u(n, [{ key: "onError", value: function (e, t, r) { return b(p(n.prototype), "emitReserved", this).call(this, "error", new yn(e, t, r)), this } }, { key: "open", value: function () { return this.readyState = "opening", this.doOpen(), this } }, { key: "close", value: function () { return "opening" !== this.readyState && "open" !== this.readyState || (this.doClose(), this.onClose()), this } }, { key: "send", value: function (e) { "open" === this.readyState && this.write(e) } }, { key: "onOpen", value: function () { this.readyState = "open", this.writable = !0, b(p(n.prototype), "emitReserved", this).call(this, "open") } }, { key: "onData", value: function (e) { var t = nn(e, this.socket.binaryType); this.onPacket(t) } }, { key: "onPacket", value: function (e) { b(p(n.prototype), "emitReserved", this).call(this, "packet", e) } }, { key: "onClose", value: function (e) { this.readyState = "closed", b(p(n.prototype), "emitReserved", this).call(this, "close", e) } }, { key: "pause", value: function (e) { } }]), n }(an), mn = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""), gn = 64, En = {}, bn = 0, _n = 0; function Cn(e) { var t = ""; do { t = mn[e % gn] + t, e = Math.floor(e / gn) } while (e > 0); return t } function kn() { var e = Cn(+new Date); return e !== dn ? (bn = 0, dn = e) : e + "." + Cn(bn++) } for (; _n < gn; _n++)En[mn[_n]] = _n; function An(e) { var t = ""; for (var n in e) e.hasOwnProperty(n) && (t.length && (t += "&"), t += encodeURIComponent(n) + "=" + encodeURIComponent(e[n])); return t } var wn = !1; try { wn = "undefined" != typeof XMLHttpRequest && "withCredentials" in new XMLHttpRequest } catch (e) { } var Sn = wn; function xn(e) { var t = e.xdomain; try { if ("undefined" != typeof XMLHttpRequest && (!t || Sn)) return new XMLHttpRequest } catch (e) { } if (!t) try { return new (cn[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP") } catch (e) { } } function Rn() { } var On = null != new xn({ xdomain: !1 }).responseType, Tn = function (e) { l(n, e); var t = E(n); function n(e) { var r; if (a(this, n), (r = t.call(this, e)).polling = !1, "undefined" != typeof location) { var i = "https:" === location.protocol, o = location.port; o || (o = i ? "443" : "80"), r.xd = "undefined" != typeof location && e.hostname !== location.hostname || o !== e.port, r.xs = e.secure !== i } var s = e && e.forceBase64; return r.supportsBinary = On && !s, r } return u(n, [{ key: "name", get: function () { return "polling" } }, { key: "doOpen", value: function () { this.poll() } }, { key: "pause", value: function (e) { var t = this; this.readyState = "pausing"; var n = function () { t.readyState = "paused", e() }; if (this.polling || !this.writable) { var r = 0; this.polling && (r++, this.once("pollComplete", (function () { --r || n() }))), this.writable || (r++, this.once("drain", (function () { --r || n() }))) } else n() } }, { key: "poll", value: function () { this.polling = !0, this.doPoll(), this.emitReserved("poll") } }, { key: "onData", value: function (e) { var t = this; (function (e, t) { for (var n = e.split(sn), r = [], i = 0; i < n.length; i++) { var o = nn(n[i], t); if (r.push(o), "error" === o.type) break } return r })(e, this.socket.binaryType).forEach((function (e) { if ("opening" === t.readyState && "open" === e.type && t.onOpen(), "close" === e.type) return t.onClose({ description: "transport closed by the server" }), !1; t.onPacket(e) })), "closed" !== this.readyState && (this.polling = !1, this.emitReserved("pollComplete"), "open" === this.readyState && this.poll()) } }, { key: "doClose", value: function () { var e = this, t = function () { e.write([{ type: "close" }]) }; "open" === this.readyState ? t() : this.once("open", t) } }, { key: "write", value: function (e) { var t = this; this.writable = !1, function (e, t) { var n = e.length, r = new Array(n), i = 0; e.forEach((function (e, o) { Xt(e, !1, (function (e) { r[o] = e, ++i === n && t(r.join(sn)) })) })) }(e, (function (e) { t.doWrite(e, (function () { t.writable = !0, t.emitReserved("drain") })) })) } }, { key: "uri", value: function () { var e = this.query || {}, t = this.opts.secure ? "https" : "http", n = ""; !1 !== this.opts.timestampRequests && (e[this.opts.timestampParam] = kn()), this.supportsBinary || e.sid || (e.b64 = 1), this.opts.port && ("https" === t && 443 !== Number(this.opts.port) || "http" === t && 80 !== Number(this.opts.port)) && (n = ":" + this.opts.port); var r = An(e); return t + "://" + (-1 !== this.opts.hostname.indexOf(":") ? "[" + this.opts.hostname + "]" : this.opts.hostname) + n + this.opts.path + (r.length ? "?" + r : "") } }, { key: "request", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return f(e, { xd: this.xd, xs: this.xs }, this.opts), new Nn(this.uri(), e) } }, { key: "doWrite", value: function (e, t) { var n = this, r = this.request({ method: "POST", data: e }); r.on("success", t), r.on("error", (function (e, t) { n.onError("xhr post error", e, t) })) } }, { key: "doPoll", value: function () { var e = this, t = this.request(); t.on("data", this.onData.bind(this)), t.on("error", (function (t, n) { e.onError("xhr poll error", t, n) })), this.pollXhr = t } }]), n }(vn), Nn = function (e) { l(n, e); var t = E(n); function n(e, r) { var i; return a(this, n), ln(g(i = t.call(this)), r), i.opts = r, i.method = r.method || "GET", i.uri = e, i.async = !1 !== r.async, i.data = void 0 !== r.data ? r.data : null, i.create(), i } return u(n, [{ key: "create", value: function () { var e = this, t = un(this.opts, "agent", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "autoUnref"); t.xdomain = !!this.opts.xd, t.xscheme = !!this.opts.xs; var r = this.xhr = new xn(t); try { r.open(this.method, this.uri, this.async); try { if (this.opts.extraHeaders) for (var i in r.setDisableHeaderCheck && r.setDisableHeaderCheck(!0), this.opts.extraHeaders) this.opts.extraHeaders.hasOwnProperty(i) && r.setRequestHeader(i, this.opts.extraHeaders[i]) } catch (e) { } if ("POST" === this.method) try { r.setRequestHeader("Content-type", "text/plain;charset=UTF-8") } catch (e) { } try { r.setRequestHeader("Accept", "*/*") } catch (e) { } "withCredentials" in r && (r.withCredentials = this.opts.withCredentials), this.opts.requestTimeout && (r.timeout = this.opts.requestTimeout), r.onreadystatechange = function () { 4 === r.readyState && (200 === r.status || 1223 === r.status ? e.onLoad() : e.setTimeoutFn((function () { e.onError("number" == typeof r.status ? r.status : 0) }), 0)) }, r.send(this.data) } catch (t) { return void this.setTimeoutFn((function () { e.onError(t) }), 0) } "undefined" != typeof document && (this.index = n.requestsCount++, n.requests[this.index] = this) } }, { key: "onError", value: function (e) { this.emitReserved("error", e, this.xhr), this.cleanup(!0) } }, { key: "cleanup", value: function (e) { if (void 0 !== this.xhr && null !== this.xhr) { if (this.xhr.onreadystatechange = Rn, e) try { this.xhr.abort() } catch (e) { } "undefined" != typeof document && delete n.requests[this.index], this.xhr = null } } }, { key: "onLoad", value: function () { var e = this.xhr.responseText; null !== e && (this.emitReserved("data", e), this.emitReserved("success"), this.cleanup()) } }, { key: "abort", value: function () { this.cleanup() } }]), n }(an); if (Nn.requestsCount = 0, Nn.requests = {}, "undefined" != typeof document) if ("function" == typeof attachEvent) attachEvent("onunload", Mn); else if ("function" == typeof addEventListener) { addEventListener("onpagehide" in cn ? "pagehide" : "unload", Mn, !1) } function Mn() { for (var e in Nn.requests) Nn.requests.hasOwnProperty(e) && Nn.requests[e].abort() } var Ln = "function" == typeof Promise && "function" == typeof Promise.resolve ? function (e) { return Promise.resolve().then(e) } : function (e, t) { return t(e, 0) }, Dn = cn.WebSocket || cn.MozWebSocket, In = "undefined" != typeof navigator && "string" == typeof navigator.product && "reactnative" === navigator.product.toLowerCase(), Pn = function (e) { l(n, e); var t = E(n); function n(e) { var r; return a(this, n), (r = t.call(this, e)).supportsBinary = !e.forceBase64, r } return u(n, [{ key: "name", get: function () { return "websocket" } }, { key: "doOpen", value: function () { if (this.check()) { var e = this.uri(), t = this.opts.protocols, n = In ? {} : un(this.opts, "agent", "perMessageDeflate", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "localAddress", "protocolVersion", "origin", "maxPayload", "family", "checkServerIdentity"); this.opts.extraHeaders && (n.headers = this.opts.extraHeaders); try { this.ws = In ? new Dn(e, t, n) : t ? new Dn(e, t) : new Dn(e) } catch (e) { return this.emitReserved("error", e) } this.ws.binaryType = this.socket.binaryType || "arraybuffer", this.addEventListeners() } } }, { key: "addEventListeners", value: function () { var e = this; this.ws.onopen = function () { e.opts.autoUnref && e.ws._socket.unref(), e.onOpen() }, this.ws.onclose = function (t) { return e.onClose({ description: "websocket connection closed", context: t }) }, this.ws.onmessage = function (t) { return e.onData(t.data) }, this.ws.onerror = function (t) { return e.onError("websocket error", t) } } }, { key: "write", value: function (e) { var t = this; this.writable = !1; for (var n = function () { var n = e[r], i = r === e.length - 1; Xt(n, t.supportsBinary, (function (e) { try { t.ws.send(e) } catch (e) { } i && Ln((function () { t.writable = !0, t.emitReserved("drain") }), t.setTimeoutFn) })) }, r = 0; r < e.length; r++)n() } }, { key: "doClose", value: function () { void 0 !== this.ws && (this.ws.close(), this.ws = null) } }, { key: "uri", value: function () { var e = this.query || {}, t = this.opts.secure ? "wss" : "ws", n = ""; this.opts.port && ("wss" === t && 443 !== Number(this.opts.port) || "ws" === t && 80 !== Number(this.opts.port)) && (n = ":" + this.opts.port), this.opts.timestampRequests && (e[this.opts.timestampParam] = kn()), this.supportsBinary || (e.b64 = 1); var r = An(e); return t + "://" + (-1 !== this.opts.hostname.indexOf(":") ? "[" + this.opts.hostname + "]" : this.opts.hostname) + n + this.opts.path + (r.length ? "?" + r : "") } }, { key: "check", value: function () { return !!Dn } }]), n }(vn), jn = { websocket: Pn, polling: Tn }, Fn = /^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/, Bn = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"]; function Un(e) { var t = e, n = e.indexOf("["), r = e.indexOf("]"); -1 != n && -1 != r && (e = e.substring(0, n) + e.substring(n, r).replace(/:/g, ";") + e.substring(r, e.length)); for (var i = Fn.exec(e || ""), o = {}, s = 14; s--;)o[Bn[s]] = i[s] || ""; return -1 != n && -1 != r && (o.source = t, o.host = o.host.substring(1, o.host.length - 1).replace(/;/g, ":"), o.authority = o.authority.replace("[", "").replace("]", "").replace(/;/g, ":"), o.ipv6uri = !0), o.pathNames = function (e, t) { var n = /\/{2,9}/g, r = t.replace(n, "/").split("/"); "/" != t.slice(0, 1) && 0 !== t.length || r.splice(0, 1); "/" == t.slice(-1) && r.splice(r.length - 1, 1); return r }(0, o.path), o.queryKey = function (e, t) { var n = {}; return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, (function (e, t, r) { t && (n[t] = r) })), n }(0, o.query), o } var Hn = function (e) { l(n, e); var t = E(n); function n(e) { var r, o = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return a(this, n), (r = t.call(this)).writeBuffer = [], e && "object" === i(e) && (o = e, e = null), e ? (e = Un(e), o.hostname = e.host, o.secure = "https" === e.protocol || "wss" === e.protocol, o.port = e.port, e.query && (o.query = e.query)) : o.host && (o.hostname = Un(o.host).host), ln(g(r), o), r.secure = null != o.secure ? o.secure : "undefined" != typeof location && "https:" === location.protocol, o.hostname && !o.port && (o.port = r.secure ? "443" : "80"), r.hostname = o.hostname || ("undefined" != typeof location ? location.hostname : "localhost"), r.port = o.port || ("undefined" != typeof location && location.port ? location.port : r.secure ? "443" : "80"), r.transports = o.transports || ["polling", "websocket"], r.writeBuffer = [], r.prevBufferLen = 0, r.opts = f({ path: "/engine.io", agent: !1, withCredentials: !1, upgrade: !0, timestampParam: "t", rememberUpgrade: !1, addTrailingSlash: !0, rejectUnauthorized: !0, perMessageDeflate: { threshold: 1024 }, transportOptions: {}, closeOnBeforeunload: !0 }, o), r.opts.path = r.opts.path.replace(/\/$/, "") + (r.opts.addTrailingSlash ? "/" : ""), "string" == typeof r.opts.query && (r.opts.query = function (e) { for (var t = {}, n = e.split("&"), r = 0, i = n.length; r < i; r++) { var o = n[r].split("="); t[decodeURIComponent(o[0])] = decodeURIComponent(o[1]) } return t }(r.opts.query)), r.id = null, r.upgrades = null, r.pingInterval = null, r.pingTimeout = null, r.pingTimeoutTimer = null, "function" == typeof addEventListener && (r.opts.closeOnBeforeunload && (r.beforeunloadEventListener = function () { r.transport && (r.transport.removeAllListeners(), r.transport.close()) }, addEventListener("beforeunload", r.beforeunloadEventListener, !1)), "localhost" !== r.hostname && (r.offlineEventListener = function () { r.onClose("transport close", { description: "network connection lost" }) }, addEventListener("offline", r.offlineEventListener, !1))), r.open(), r } return u(n, [{ key: "createTransport", value: function (e) { var t = f({}, this.opts.query); t.EIO = 4, t.transport = e, this.id && (t.sid = this.id); var n = f({}, this.opts.transportOptions[e], this.opts, { query: t, socket: this, hostname: this.hostname, secure: this.secure, port: this.port }); return new jn[e](n) } }, { key: "open", value: function () { var e, t = this; if (this.opts.rememberUpgrade && n.priorWebsocketSuccess && -1 !== this.transports.indexOf("websocket")) e = "websocket"; else { if (0 === this.transports.length) return void this.setTimeoutFn((function () { t.emitReserved("error", "No transports available") }), 0); e = this.transports[0] } this.readyState = "opening"; try { e = this.createTransport(e) } catch (e) { return this.transports.shift(), void this.open() } e.open(), this.setTransport(e) } }, { key: "setTransport", value: function (e) { var t = this; this.transport && this.transport.removeAllListeners(), this.transport = e, e.on("drain", this.onDrain.bind(this)).on("packet", this.onPacket.bind(this)).on("error", this.onError.bind(this)).on("close", (function (e) { return t.onClose("transport close", e) })) } }, { key: "probe", value: function (e) { var t = this, r = this.createTransport(e), i = !1; n.priorWebsocketSuccess = !1; var o = function () { i || (r.send([{ type: "ping", data: "probe" }]), r.once("packet", (function (e) { if (!i) if ("pong" === e.type && "probe" === e.data) { if (t.upgrading = !0, t.emitReserved("upgrading", r), !r) return; n.priorWebsocketSuccess = "websocket" === r.name, t.transport.pause((function () { i || "closed" !== t.readyState && (f(), t.setTransport(r), r.send([{ type: "upgrade" }]), t.emitReserved("upgrade", r), r = null, t.upgrading = !1, t.flush()) })) } else { var o = new Error("probe error"); o.transport = r.name, t.emitReserved("upgradeError", o) } }))) }; function s() { i || (i = !0, f(), r.close(), r = null) } var a = function (e) { var n = new Error("probe error: " + e); n.transport = r.name, s(), t.emitReserved("upgradeError", n) }; function c() { a("transport closed") } function u() { a("socket closed") } function h(e) { r && e.name !== r.name && s() } var f = function () { r.removeListener("open", o), r.removeListener("error", a), r.removeListener("close", c), t.off("close", u), t.off("upgrading", h) }; r.once("open", o), r.once("error", a), r.once("close", c), this.once("close", u), this.once("upgrading", h), r.open() } }, { key: "onOpen", value: function () { if (this.readyState = "open", n.priorWebsocketSuccess = "websocket" === this.transport.name, this.emitReserved("open"), this.flush(), "open" === this.readyState && this.opts.upgrade) for (var e = 0, t = this.upgrades.length; e < t; e++)this.probe(this.upgrades[e]) } }, { key: "onPacket", value: function (e) { if ("opening" === this.readyState || "open" === this.readyState || "closing" === this.readyState) switch (this.emitReserved("packet", e), this.emitReserved("heartbeat"), e.type) { case "open": this.onHandshake(JSON.parse(e.data)); break; case "ping": this.resetPingTimeout(), this.sendPacket("pong"), this.emitReserved("ping"), this.emitReserved("pong"); break; case "error": var t = new Error("server error"); t.code = e.data, this.onError(t); break; case "message": this.emitReserved("data", e.data), this.emitReserved("message", e.data) } } }, { key: "onHandshake", value: function (e) { this.emitReserved("handshake", e), this.id = e.sid, this.transport.query.sid = e.sid, this.upgrades = this.filterUpgrades(e.upgrades), this.pingInterval = e.pingInterval, this.pingTimeout = e.pingTimeout, this.maxPayload = e.maxPayload, this.onOpen(), "closed" !== this.readyState && this.resetPingTimeout() } }, { key: "resetPingTimeout", value: function () { var e = this; this.clearTimeoutFn(this.pingTimeoutTimer), this.pingTimeoutTimer = this.setTimeoutFn((function () { e.onClose("ping timeout") }), this.pingInterval + this.pingTimeout), this.opts.autoUnref && this.pingTimeoutTimer.unref() } }, { key: "onDrain", value: function () { this.writeBuffer.splice(0, this.prevBufferLen), this.prevBufferLen = 0, 0 === this.writeBuffer.length ? this.emitReserved("drain") : this.flush() } }, { key: "flush", value: function () { if ("closed" !== this.readyState && this.transport.writable && !this.upgrading && this.writeBuffer.length) { var e = this.getWritablePackets(); this.transport.send(e), this.prevBufferLen = e.length, this.emitReserved("flush") } } }, { key: "getWritablePackets", value: function () { if (!(this.maxPayload && "polling" === this.transport.name && this.writeBuffer.length > 1)) return this.writeBuffer; for (var e, t = 1, n = 0; n < this.writeBuffer.length; n++) { var r = this.writeBuffer[n].data; if (r && (t += "string" == typeof (e = r) ? function (e) { for (var t = 0, n = 0, r = 0, i = e.length; r < i; r++)(t = e.charCodeAt(r)) < 128 ? n += 1 : t < 2048 ? n += 2 : t < 55296 || t >= 57344 ? n += 3 : (r++, n += 4); return n }(e) : Math.ceil((e.byteLength || e.size) * pn)), n > 0 && t > this.maxPayload) return this.writeBuffer.slice(0, n); t += 2 } return this.writeBuffer } }, { key: "write", value: function (e, t, n) { return this.sendPacket("message", e, t, n), this } }, { key: "send", value: function (e, t, n) { return this.sendPacket("message", e, t, n), this } }, { key: "sendPacket", value: function (e, t, n, r) { if ("function" == typeof t && (r = t, t = void 0), "function" == typeof n && (r = n, n = null), "closing" !== this.readyState && "closed" !== this.readyState) { (n = n || {}).compress = !1 !== n.compress; var i = { type: e, data: t, options: n }; this.emitReserved("packetCreate", i), this.writeBuffer.push(i), r && this.once("flush", r), this.flush() } } }, { key: "close", value: function () { var e = this, t = function () { e.onClose("forced close"), e.transport.close() }, n = function n() { e.off("upgrade", n), e.off("upgradeError", n), t() }, r = function () { e.once("upgrade", n), e.once("upgradeError", n) }; return "opening" !== this.readyState && "open" !== this.readyState || (this.readyState = "closing", this.writeBuffer.length ? this.once("drain", (function () { e.upgrading ? r() : t() })) : this.upgrading ? r() : t()), this } }, { key: "onError", value: function (e) { n.priorWebsocketSuccess = !1, this.emitReserved("error", e), this.onClose("transport error", e) } }, { key: "onClose", value: function (e, t) { "opening" !== this.readyState && "open" !== this.readyState && "closing" !== this.readyState || (this.clearTimeoutFn(this.pingTimeoutTimer), this.transport.removeAllListeners("close"), this.transport.close(), this.transport.removeAllListeners(), "function" == typeof removeEventListener && (removeEventListener("beforeunload", this.beforeunloadEventListener, !1), removeEventListener("offline", this.offlineEventListener, !1)), this.readyState = "closed", this.id = null, this.emitReserved("close", e, t), this.writeBuffer = [], this.prevBufferLen = 0) } }, { key: "filterUpgrades", value: function (e) { for (var t = [], n = 0, r = e.length; n < r; n++)~this.transports.indexOf(e[n]) && t.push(e[n]); return t } }]), n }(an); Hn.protocol = 4, Hn.protocol; var qn = "function" == typeof ArrayBuffer, Vn = function (e) { return "function" == typeof ArrayBuffer.isView ? ArrayBuffer.isView(e) : e.buffer instanceof ArrayBuffer }, Gn = Object.prototype.toString, Kn = "function" == typeof Blob || "undefined" != typeof Blob && "[object BlobConstructor]" === Gn.call(Blob), Yn = "function" == typeof File || "undefined" != typeof File && "[object FileConstructor]" === Gn.call(File); function zn(e) { return qn && (e instanceof ArrayBuffer || Vn(e)) || Kn && e instanceof Blob || Yn && e instanceof File } function Jn(e, t) { if (!e || "object" !== i(e)) return !1; if (Array.isArray(e)) { for (var n = 0, r = e.length; n < r; n++)if (Jn(e[n])) return !0; return !1 } if (zn(e)) return !0; if (e.toJSON && "function" == typeof e.toJSON && 1 === arguments.length) return Jn(e.toJSON(), !0); for (var o in e) if (Object.prototype.hasOwnProperty.call(e, o) && Jn(e[o])) return !0; return !1 } function Wn(e) { var t = [], n = e.data, r = e; return r.data = Xn(n, t), r.attachments = t.length, { packet: r, buffers: t } } function Xn(e, t) { if (!e) return e; if (zn(e)) { var n = { _placeholder: !0, num: t.length }; return t.push(e), n } if (Array.isArray(e)) { for (var r = new Array(e.length), o = 0; o < e.length; o++)r[o] = Xn(e[o], t); return r } if ("object" === i(e) && !(e instanceof Date)) { var s = {}; for (var a in e) Object.prototype.hasOwnProperty.call(e, a) && (s[a] = Xn(e[a], t)); return s } return e } function $n(e, t) { return e.data = Qn(e.data, t), delete e.attachments, e } function Qn(e, t) { if (!e) return e; if (e && !0 === e._placeholder) { if ("number" == typeof e.num && e.num >= 0 && e.num < t.length) return t[e.num]; throw new Error("illegal attachments") } if (Array.isArray(e)) for (var n = 0; n < e.length; n++)e[n] = Qn(e[n], t); else if ("object" === i(e)) for (var r in e) Object.prototype.hasOwnProperty.call(e, r) && (e[r] = Qn(e[r], t)); return e } var Zn; !function (e) { e[e.CONNECT = 0] = "CONNECT", e[e.DISCONNECT = 1] = "DISCONNECT", e[e.EVENT = 2] = "EVENT", e[e.ACK = 3] = "ACK", e[e.CONNECT_ERROR = 4] = "CONNECT_ERROR", e[e.BINARY_EVENT = 5] = "BINARY_EVENT", e[e.BINARY_ACK = 6] = "BINARY_ACK" }(Zn || (Zn = {})); var er = function () { function e(t) { a(this, e), this.replacer = t } return u(e, [{ key: "encode", value: function (e) { return e.type !== Zn.EVENT && e.type !== Zn.ACK || !Jn(e) ? [this.encodeAsString(e)] : this.encodeAsBinary({ type: e.type === Zn.EVENT ? Zn.BINARY_EVENT : Zn.BINARY_ACK, nsp: e.nsp, data: e.data, id: e.id }) } }, { key: "encodeAsString", value: function (e) { var t = "" + e.type; return e.type !== Zn.BINARY_EVENT && e.type !== Zn.BINARY_ACK || (t += e.attachments + "-"), e.nsp && "/" !== e.nsp && (t += e.nsp + ","), null != e.id && (t += e.id), null != e.data && (t += JSON.stringify(e.data, this.replacer)), t } }, { key: "encodeAsBinary", value: function (e) { var t = Wn(e), n = this.encodeAsString(t.packet), r = t.buffers; return r.unshift(n), r } }]), e }(), tr = function (e) { l(n, e); var t = E(n); function n(e) { var r; return a(this, n), (r = t.call(this)).reviver = e, r } return u(n, [{ key: "add", value: function (e) { var t; if ("string" == typeof e) { if (this.reconstructor) throw new Error("got plaintext data when reconstructing a packet"); var r = (t = this.decodeString(e)).type === Zn.BINARY_EVENT; r || t.type === Zn.BINARY_ACK ? (t.type = r ? Zn.EVENT : Zn.ACK, this.reconstructor = new nr(t), 0 === t.attachments && b(p(n.prototype), "emitReserved", this).call(this, "decoded", t)) : b(p(n.prototype), "emitReserved", this).call(this, "decoded", t) } else { if (!zn(e) && !e.base64) throw new Error("Unknown type: " + e); if (!this.reconstructor) throw new Error("got binary data when not reconstructing a packet"); (t = this.reconstructor.takeBinaryData(e)) && (this.reconstructor = null, b(p(n.prototype), "emitReserved", this).call(this, "decoded", t)) } } }, { key: "decodeString", value: function (e) { var t = 0, r = { type: Number(e.charAt(0)) }; if (void 0 === Zn[r.type]) throw new Error("unknown packet type " + r.type); if (r.type === Zn.BINARY_EVENT || r.type === Zn.BINARY_ACK) { for (var i = t + 1; "-" !== e.charAt(++t) && t != e.length;); var o = e.substring(i, t); if (o != Number(o) || "-" !== e.charAt(t)) throw new Error("Illegal attachments"); r.attachments = Number(o) } if ("/" === e.charAt(t + 1)) { for (var s = t + 1; ++t;) { if ("," === e.charAt(t)) break; if (t === e.length) break } r.nsp = e.substring(s, t) } else r.nsp = "/"; var a = e.charAt(t + 1); if ("" !== a && Number(a) == a) { for (var c = t + 1; ++t;) { var u = e.charAt(t); if (null == u || Number(u) != u) { --t; break } if (t === e.length) break } r.id = Number(e.substring(c, t + 1)) } if (e.charAt(++t)) { var h = this.tryParse(e.substr(t)); if (!n.isPayloadValid(r.type, h)) throw new Error("invalid payload"); r.data = h } return r } }, { key: "tryParse", value: function (e) { try { return JSON.parse(e, this.reviver) } catch (e) { return !1 } } }, { key: "destroy", value: function () { this.reconstructor && (this.reconstructor.finishedReconstruction(), this.reconstructor = null) } }], [{ key: "isPayloadValid", value: function (e, t) { switch (e) { case Zn.CONNECT: return "object" === i(t); case Zn.DISCONNECT: return void 0 === t; case Zn.CONNECT_ERROR: return "string" == typeof t || "object" === i(t); case Zn.EVENT: case Zn.BINARY_EVENT: return Array.isArray(t) && t.length > 0; case Zn.ACK: case Zn.BINARY_ACK: return Array.isArray(t) } } }]), n }(an), nr = function () { function e(t) { a(this, e), this.packet = t, this.buffers = [], this.reconPack = t } return u(e, [{ key: "takeBinaryData", value: function (e) { if (this.buffers.push(e), this.buffers.length === this.reconPack.attachments) { var t = $n(this.reconPack, this.buffers); return this.finishedReconstruction(), t } return null } }, { key: "finishedReconstruction", value: function () { this.reconPack = null, this.buffers = [] } }]), e }(), rr = Object.freeze({ __proto__: null, protocol: 5, get PacketType() { return Zn }, Encoder: er, Decoder: tr }); function ir(e, t, n) { return e.on(t, n), function () { e.off(t, n) } } var or = Object.freeze({ connect: 1, connect_error: 1, disconnect: 1, disconnecting: 1, newListener: 1, removeListener: 1 }), sr = function (e) { l(n, e); var t = E(n); function n(e, r, i) { var o; return a(this, n), (o = t.call(this)).connected = !1, o.recovered = !1, o.receiveBuffer = [], o.sendBuffer = [], o._queue = [], o._queueSeq = 0, o.ids = 0, o.acks = {}, o.flags = {}, o.io = e, o.nsp = r, i && i.auth && (o.auth = i.auth), o._opts = f({}, i), o.io._autoConnect && o.open(), o } return u(n, [{ key: "disconnected", get: function () { return !this.connected } }, { key: "subEvents", value: function () { if (!this.subs) { var e = this.io; this.subs = [ir(e, "open", this.onopen.bind(this)), ir(e, "packet", this.onpacket.bind(this)), ir(e, "error", this.onerror.bind(this)), ir(e, "close", this.onclose.bind(this))] } } }, { key: "active", get: function () { return !!this.subs } }, { key: "connect", value: function () { return this.connected || (this.subEvents(), this.io._reconnecting || this.io.open(), "open" === this.io._readyState && this.onopen()), this } }, { key: "open", value: function () { return this.connect() } }, { key: "send", value: function () { for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++)t[n] = arguments[n]; return t.unshift("message"), this.emit.apply(this, t), this } }, { key: "emit", value: function (e) { if (or.hasOwnProperty(e)) throw new Error('"' + e.toString() + '" is a reserved event name'); for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++)n[r - 1] = arguments[r]; if (n.unshift(e), this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) return this._addToQueue(n), this; var i = { type: Zn.EVENT, data: n, options: {} }; if (i.options.compress = !1 !== this.flags.compress, "function" == typeof n[n.length - 1]) { var o = this.ids++, s = n.pop(); this._registerAckCallback(o, s), i.id = o } var a = this.io.engine && this.io.engine.transport && this.io.engine.transport.writable; return this.flags.volatile && (!a || !this.connected) || (this.connected ? (this.notifyOutgoingListeners(i), this.packet(i)) : this.sendBuffer.push(i)), this.flags = {}, this } }, { key: "_registerAckCallback", value: function (e, t) { var n, r = this, i = null !== (n = this.flags.timeout) && void 0 !== n ? n : this._opts.ackTimeout; if (void 0 !== i) { var o = this.io.setTimeoutFn((function () { delete r.acks[e]; for (var n = 0; n < r.sendBuffer.length; n++)r.sendBuffer[n].id === e && r.sendBuffer.splice(n, 1); t.call(r, new Error("operation has timed out")) }), i); this.acks[e] = function () { r.io.clearTimeoutFn(o); for (var e = arguments.length, n = new Array(e), i = 0; i < e; i++)n[i] = arguments[i]; t.apply(r, [null].concat(n)) } } else this.acks[e] = t } }, { key: "emitWithAck", value: function (e) { for (var t = this, n = arguments.length, r = new Array(n > 1 ? n - 1 : 0), i = 1; i < n; i++)r[i - 1] = arguments[i]; var o = void 0 !== this.flags.timeout || void 0 !== this._opts.ackTimeout; return new Promise((function (n, i) { r.push((function (e, t) { return o ? e ? i(e) : n(t) : n(e) })), t.emit.apply(t, [e].concat(r)) })) } }, { key: "_addToQueue", value: function (e) { var t, n = this; "function" == typeof e[e.length - 1] && (t = e.pop()); var r = { id: this._queueSeq++, tryCount: 0, pending: !1, args: e, flags: f({ fromQueue: !0 }, this.flags) }; e.push((function (e) { if (r === n._queue[0]) { if (null !== e) r.tryCount > n._opts.retries && (n._queue.shift(), t && t(e)); else if (n._queue.shift(), t) { for (var i = arguments.length, o = new Array(i > 1 ? i - 1 : 0), s = 1; s < i; s++)o[s - 1] = arguments[s]; t.apply(void 0, [null].concat(o)) } return r.pending = !1, n._drainQueue() } })), this._queue.push(r), this._drainQueue() } }, { key: "_drainQueue", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0]; if (this.connected && 0 !== this._queue.length) { var t = this._queue[0]; t.pending && !e || (t.pending = !0, t.tryCount++, this.flags = t.flags, this.emit.apply(this, t.args)) } } }, { key: "packet", value: function (e) { e.nsp = this.nsp, this.io._packet(e) } }, { key: "onopen", value: function () { var e = this; "function" == typeof this.auth ? this.auth((function (t) { e._sendConnectPacket(t) })) : this._sendConnectPacket(this.auth) } }, { key: "_sendConnectPacket", value: function (e) { this.packet({ type: Zn.CONNECT, data: this._pid ? f({ pid: this._pid, offset: this._lastOffset }, e) : e }) } }, { key: "onerror", value: function (e) { this.connected || this.emitReserved("connect_error", e) } }, { key: "onclose", value: function (e, t) { this.connected = !1, delete this.id, this.emitReserved("disconnect", e, t) } }, { key: "onpacket", value: function (e) { if (e.nsp === this.nsp) switch (e.type) { case Zn.CONNECT: e.data && e.data.sid ? this.onconnect(e.data.sid, e.data.pid) : this.emitReserved("connect_error", new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)")); break; case Zn.EVENT: case Zn.BINARY_EVENT: this.onevent(e); break; case Zn.ACK: case Zn.BINARY_ACK: this.onack(e); break; case Zn.DISCONNECT: this.ondisconnect(); break; case Zn.CONNECT_ERROR: this.destroy(); var t = new Error(e.data.message); t.data = e.data.data, this.emitReserved("connect_error", t) } } }, { key: "onevent", value: function (e) { var t = e.data || []; null != e.id && t.push(this.ack(e.id)), this.connected ? this.emitEvent(t) : this.receiveBuffer.push(Object.freeze(t)) } }, { key: "emitEvent", value: function (e) { if (this._anyListeners && this._anyListeners.length) { var t, r = C(this._anyListeners.slice()); try { for (r.s(); !(t = r.n()).done;) { t.value.apply(this, e) } } catch (e) { r.e(e) } finally { r.f() } } b(p(n.prototype), "emit", this).apply(this, e), this._pid && e.length && "string" == typeof e[e.length - 1] && (this._lastOffset = e[e.length - 1]) } }, { key: "ack", value: function (e) { var t = this, n = !1; return function () { if (!n) { n = !0; for (var r = arguments.length, i = new Array(r), o = 0; o < r; o++)i[o] = arguments[o]; t.packet({ type: Zn.ACK, id: e, data: i }) } } } }, { key: "onack", value: function (e) { var t = this.acks[e.id]; "function" == typeof t && (t.apply(this, e.data), delete this.acks[e.id]) } }, { key: "onconnect", value: function (e, t) { this.id = e, this.recovered = t && this._pid === t, this._pid = t, this.connected = !0, this.emitBuffered(), this.emitReserved("connect"), this._drainQueue(!0) } }, { key: "emitBuffered", value: function () { var e = this; this.receiveBuffer.forEach((function (t) { return e.emitEvent(t) })), this.receiveBuffer = [], this.sendBuffer.forEach((function (t) { e.notifyOutgoingListeners(t), e.packet(t) })), this.sendBuffer = [] } }, { key: "ondisconnect", value: function () { this.destroy(), this.onclose("io server disconnect") } }, { key: "destroy", value: function () { this.subs && (this.subs.forEach((function (e) { return e() })), this.subs = void 0), this.io._destroy(this) } }, { key: "disconnect", value: function () { return this.connected && this.packet({ type: Zn.DISCONNECT }), this.destroy(), this.connected && this.onclose("io client disconnect"), this } }, { key: "close", value: function () { return this.disconnect() } }, { key: "compress", value: function (e) { return this.flags.compress = e, this } }, { key: "volatile", get: function () { return this.flags.volatile = !0, this } }, { key: "timeout", value: function (e) { return this.flags.timeout = e, this } }, { key: "onAny", value: function (e) { return this._anyListeners = this._anyListeners || [], this._anyListeners.push(e), this } }, { key: "prependAny", value: function (e) { return this._anyListeners = this._anyListeners || [], this._anyListeners.unshift(e), this } }, { key: "offAny", value: function (e) { if (!this._anyListeners) return this; if (e) { for (var t = this._anyListeners, n = 0; n < t.length; n++)if (e === t[n]) return t.splice(n, 1), this } else this._anyListeners = []; return this } }, { key: "listenersAny", value: function () { return this._anyListeners || [] } }, { key: "onAnyOutgoing", value: function (e) { return this._anyOutgoingListeners = this._anyOutgoingListeners || [], this._anyOutgoingListeners.push(e), this } }, { key: "prependAnyOutgoing", value: function (e) { return this._anyOutgoingListeners = this._anyOutgoingListeners || [], this._anyOutgoingListeners.unshift(e), this } }, { key: "offAnyOutgoing", value: function (e) { if (!this._anyOutgoingListeners) return this; if (e) { for (var t = this._anyOutgoingListeners, n = 0; n < t.length; n++)if (e === t[n]) return t.splice(n, 1), this } else this._anyOutgoingListeners = []; return this } }, { key: "listenersAnyOutgoing", value: function () { return this._anyOutgoingListeners || [] } }, { key: "notifyOutgoingListeners", value: function (e) { if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) { var t, n = C(this._anyOutgoingListeners.slice()); try { for (n.s(); !(t = n.n()).done;) { t.value.apply(this, e.data) } } catch (e) { n.e(e) } finally { n.f() } } } }]), n }(an); function ar(e) { e = e || {}, this.ms = e.min || 100, this.max = e.max || 1e4, this.factor = e.factor || 2, this.jitter = e.jitter > 0 && e.jitter <= 1 ? e.jitter : 0, this.attempts = 0 } ar.prototype.duration = function () { var e = this.ms * Math.pow(this.factor, this.attempts++); if (this.jitter) { var t = Math.random(), n = Math.floor(t * this.jitter * e); e = 0 == (1 & Math.floor(10 * t)) ? e - n : e + n } return 0 | Math.min(e, this.max) }, ar.prototype.reset = function () { this.attempts = 0 }, ar.prototype.setMin = function (e) { this.ms = e }, ar.prototype.setMax = function (e) { this.max = e }, ar.prototype.setJitter = function (e) { this.jitter = e }; var cr = function (e) { l(n, e); var t = E(n); function n(e, r) { var o, s; a(this, n), (o = t.call(this)).nsps = {}, o.subs = [], e && "object" === i(e) && (r = e, e = void 0), (r = r || {}).path = r.path || "/socket.io", o.opts = r, ln(g(o), r), o.reconnection(!1 !== r.reconnection), o.reconnectionAttempts(r.reconnectionAttempts || 1 / 0), o.reconnectionDelay(r.reconnectionDelay || 1e3), o.reconnectionDelayMax(r.reconnectionDelayMax || 5e3), o.randomizationFactor(null !== (s = r.randomizationFactor) && void 0 !== s ? s : .5), o.backoff = new ar({ min: o.reconnectionDelay(), max: o.reconnectionDelayMax(), jitter: o.randomizationFactor() }), o.timeout(null == r.timeout ? 2e4 : r.timeout), o._readyState = "closed", o.uri = e; var c = r.parser || rr; return o.encoder = new c.Encoder, o.decoder = new c.Decoder, o._autoConnect = !1 !== r.autoConnect, o._autoConnect && o.open(), o } return u(n, [{ key: "reconnection", value: function (e) { return arguments.length ? (this._reconnection = !!e, this) : this._reconnection } }, { key: "reconnectionAttempts", value: function (e) { return void 0 === e ? this._reconnectionAttempts : (this._reconnectionAttempts = e, this) } }, { key: "reconnectionDelay", value: function (e) { var t; return void 0 === e ? this._reconnectionDelay : (this._reconnectionDelay = e, null === (t = this.backoff) || void 0 === t || t.setMin(e), this) } }, { key: "randomizationFactor", value: function (e) { var t; return void 0 === e ? this._randomizationFactor : (this._randomizationFactor = e, null === (t = this.backoff) || void 0 === t || t.setJitter(e), this) } }, { key: "reconnectionDelayMax", value: function (e) { var t; return void 0 === e ? this._reconnectionDelayMax : (this._reconnectionDelayMax = e, null === (t = this.backoff) || void 0 === t || t.setMax(e), this) } }, { key: "timeout", value: function (e) { return arguments.length ? (this._timeout = e, this) : this._timeout } }, { key: "maybeReconnectOnOpen", value: function () { !this._reconnecting && this._reconnection && 0 === this.backoff.attempts && this.reconnect() } }, { key: "open", value: function (e) { var t = this; if (~this._readyState.indexOf("open")) return this; this.engine = new Hn(this.uri, this.opts); var n = this.engine, r = this; this._readyState = "opening", this.skipReconnect = !1; var i = ir(n, "open", (function () { r.onopen(), e && e() })), o = ir(n, "error", (function (n) { r.cleanup(), r._readyState = "closed", t.emitReserved("error", n), e ? e(n) : r.maybeReconnectOnOpen() })); if (!1 !== this._timeout) { var s = this._timeout; 0 === s && i(); var a = this.setTimeoutFn((function () { i(), n.close(), n.emit("error", new Error("timeout")) }), s); this.opts.autoUnref && a.unref(), this.subs.push((function () { clearTimeout(a) })) } return this.subs.push(i), this.subs.push(o), this } }, { key: "connect", value: function (e) { return this.open(e) } }, { key: "onopen", value: function () { this.cleanup(), this._readyState = "open", this.emitReserved("open"); var e = this.engine; this.subs.push(ir(e, "ping", this.onping.bind(this)), ir(e, "data", this.ondata.bind(this)), ir(e, "error", this.onerror.bind(this)), ir(e, "close", this.onclose.bind(this)), ir(this.decoder, "decoded", this.ondecoded.bind(this))) } }, { key: "onping", value: function () { this.emitReserved("ping") } }, { key: "ondata", value: function (e) { try { this.decoder.add(e) } catch (e) { this.onclose("parse error", e) } } }, { key: "ondecoded", value: function (e) { var t = this; Ln((function () { t.emitReserved("packet", e) }), this.setTimeoutFn) } }, { key: "onerror", value: function (e) { this.emitReserved("error", e) } }, { key: "socket", value: function (e, t) { var n = this.nsps[e]; return n ? this._autoConnect && !n.active && n.connect() : (n = new sr(this, e, t), this.nsps[e] = n), n } }, { key: "_destroy", value: function (e) { for (var t = 0, n = Object.keys(this.nsps); t < n.length; t++) { var r = n[t]; if (this.nsps[r].active) return } this._close() } }, { key: "_packet", value: function (e) { for (var t = this.encoder.encode(e), n = 0; n < t.length; n++)this.engine.write(t[n], e.options) } }, { key: "cleanup", value: function () { this.subs.forEach((function (e) { return e() })), this.subs.length = 0, this.decoder.destroy() } }, { key: "_close", value: function () { this.skipReconnect = !0, this._reconnecting = !1, this.onclose("forced close"), this.engine && this.engine.close() } }, { key: "disconnect", value: function () { return this._close() } }, { key: "onclose", value: function (e, t) { this.cleanup(), this.backoff.reset(), this._readyState = "closed", this.emitReserved("close", e, t), this._reconnection && !this.skipReconnect && this.reconnect() } }, { key: "reconnect", value: function () { var e = this; if (this._reconnecting || this.skipReconnect) return this; var t = this; if (this.backoff.attempts >= this._reconnectionAttempts) this.backoff.reset(), this.emitReserved("reconnect_failed"), this._reconnecting = !1; else { var n = this.backoff.duration(); this._reconnecting = !0; var r = this.setTimeoutFn((function () { t.skipReconnect || (e.emitReserved("reconnect_attempt", t.backoff.attempts), t.skipReconnect || t.open((function (n) { n ? (t._reconnecting = !1, t.reconnect(), e.emitReserved("reconnect_error", n)) : t.onreconnect() }))) }), n); this.opts.autoUnref && r.unref(), this.subs.push((function () { clearTimeout(r) })) } } }, { key: "onreconnect", value: function () { var e = this.backoff.attempts; this._reconnecting = !1, this.backoff.reset(), this.emitReserved("reconnect", e) } }]), n }(an), ur = {}; function hr(e, t) { "object" === i(e) && (t = e, e = void 0); var n, r = function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "", n = arguments.length > 2 ? arguments[2] : void 0, r = e; n = n || "undefined" != typeof location && location, null == e && (e = n.protocol + "//" + n.host), "string" == typeof e && ("/" === e.charAt(0) && (e = "/" === e.charAt(1) ? n.protocol + e : n.host + e), /^(https?|wss?):\/\//.test(e) || (e = void 0 !== n ? n.protocol + "//" + e : "https://" + e), r = Un(e)), r.port || (/^(http|ws)$/.test(r.protocol) ? r.port = "80" : /^(http|ws)s$/.test(r.protocol) && (r.port = "443")), r.path = r.path || "/"; var i = -1 !== r.host.indexOf(":") ? "[" + r.host + "]" : r.host; return r.id = r.protocol + "://" + i + ":" + r.port + t, r.href = r.protocol + "://" + i + (n && n.port === r.port ? "" : ":" + r.port), r }(e, (t = t || {}).path || "/socket.io"), o = r.source, s = r.id, a = r.path, c = ur[s] && a in ur[s].nsps; return t.forceNew || t["force new connection"] || !1 === t.multiplex || c ? n = new cr(o, t) : (ur[s] || (ur[s] = new cr(o, t)), n = ur[s]), r.query && !t.query && (t.query = r.queryKey), n.socket(r.path, t) } f(hr, { Manager: cr, Socket: sr, io: hr, connect: hr }); var fr = "object" == ("undefined" == typeof self ? "undefined" : i(self)) ? self.FormData : window.FormData, lr = function () { function e(t) { a(this, e), this.chatlist = t.chatlist, this.onChatConnect = t.onChatConnect, this.onChatRefresh = t.onChatRefresh, this.onChatLeave = t.onChatLeave, this.onMessageSend = t.onMessageSend, this.onMessagesFetch = t.onMessagesFetch, this.onMessageReceive = t.onMessageReceive, this.onMessagesUpdate = t.onMessagesUpdate } return u(e, [{ key: "connect", value: function (e) { var t, n, r, i; e.with && ("string" == typeof e.with && (e.with = [e.with]), e.with = e.with.filter((function (e) { return e && "undefined" !== e && "null" !== e })), e.with.push(null === (t = dr.member) || void 0 === t ? void 0 : t.id), e.with = e.with.filter((function (e, t, n) { return n.indexOf(e) === t })), e.with.length < 2) ? console.warn(":: ChattyChat connect error - chat member count should not be less than 2") : e.distinctKey && "string" != typeof e.distinctKey ? console.warn(":: ChattyChat connect error - distinctKey must be string. Use static method Chatty.generateDistinctKey() to generate distinctKey") : (Object.keys(e).forEach((function (t) { return !e[t] && delete e[t] })), this.socket = hr("wss://devsocket.chatty-cloud.com" + "/chat.".concat(null === (n = dr.app) || void 0 === n ? void 0 : n.name), { transports: ["websocket"], query: { MemberId: (null === (r = dr.member) || void 0 === r ? void 0 : r.id) || "", AppId: (null === (i = dr.app) || void 0 === i ? void 0 : i.id) || "", at: e.at || "", with: e.with || "", distinctKey: e.distinctKey || "", group: e.group || "", name: e.name || "", image: e.image || "", data: e.data && JSON.stringify(e.data) || "" }, auth: { apikey: dr.apiKey || "" }, forceNew: !0 }), this.addListener()) } }, { key: "disconnect", value: function () { var e; null === (e = this.socket) || void 0 === e || e.disconnect(), this.removeListener(), console.debug(":: ChattyChat disconnected") } }, { key: "fetchMessages", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.FETCH_MESSAGES, { refresh: e.refresh }) } }, { key: "sendMessage", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.SEND_MESSAGE, n(n({}, e), {}, { retry: 5 })) } }, { key: "deleteMessage", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.DELETE_MESSAGE, { id: e }) } }, { key: "refreshChat", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.REFRESH_CHAT, { ChatId: e }) } }, { key: "leaveChat", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.LEAVE_CHAT, { ChatId: e }) } }, { key: "inviteMembers", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.INVITE_MEMBERS, { MemberIds: e }) } }, { key: "excludeMembers", value: function (e) { var t; null === (t = this.socket) || void 0 === t || t.emit(M.EXCLUDE_MEMBERS, { MemberIds: e }) } }, { key: "markAsRead", value: function () { var e; null === (e = this.socket) || void 0 === e || e.emit(M.MARK_AS_READ) } }, { key: "sendTextMessage", value: function (e) { var t; if (e) { if (this.id) { var r = { id: "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (function (e) { var t = 16 * Math.random() | 0; return ("x" == e ? t : 3 & t | 8).toString(16) })), createdAt: new Date, text: e, type: O.TEXT, by: T.USER, SenderId: null === (t = dr.member) || void 0 === t ? void 0 : t.id }; return this.sendMessage(r), delete r.SenderId, n(n({}, r), {}, { files: [], json: null, translation: null, readReceipt: 0, updatedAt: new Date, deletedAt: null, AppId: dr.app.id, ChatId: this.id, Sender: dr.member }) } console.warn(":: ChattyChat sendTextMessage error - Chat not connected yet") } else console.warn(":: ChattyChat sendTextMessage error - text is empty") } }, { key: "sendFileMessage", value: function (e) { var t, r = this; if (e) if (e.length > 4) console.warn(":: ChattyChat sendFileMessage function param error: number of files can not be over 4"); else { if (this.id) { var i = { id: "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (function (e) { var t = 16 * Math.random() | 0; return ("x" == e ? t : 3 & t | 8).toString(16) })), createdAt: new Date, files: e, text: "File Message", type: O.FILE, by: T.USER, SenderId: null === (t = dr.member) || void 0 === t ? void 0 : t.id }; return this.uploadFiles(e).then((function (e) { console.debug(":: ChattyChat uploadFiles success", e), r.sendMessage(n(n({}, i), {}, { files: e })) })).catch((function (e) { console.warn(":: ChattyChat uploadFiles error", e.message) })), delete i.SenderId, n(n({}, i), {}, { json: null, translation: null, readReceipt: 0, updatedAt: new Date, deletedAt: null, AppId: dr.app.id, ChatId: this.id, Sender: dr.member }) } console.warn(":: ChattyChat sendTextMessage error - Chat not connected yet") } else console.warn(":: ChattyChat sendFileMessage function param error: files are undefined") } }, { key: "uploadFiles", value: function (e) { return new Promise(function () { var t = s(r().mark((function t(n, i) { var o; return r().wrap((function (t) { for (; ;)switch (t.prev = t.next) { case 0: return t.prev = 0, dr.axiosInstance || i(":: ChattyClient is not initailized"), pr(e, dr.app) || i(":: ChattyClient uploadFiles - File validations are failed"), t.next = 5, Promise.all(e.map(function () { var e = s(r().mark((function e(t) { var n, o, s, a, c, u, h; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: return (a = new fr).append("file", t), e.next = 4, null === (n = dr.axiosInstance) || void 0 === n ? void 0 : n.get("/uploadurl"); case 4: return (null == (c = e.sent) ? void 0 : c.data) || i(":: ChattyClient uploadFiles - Getting uploadUrl failed"), e.next = 8, Gt.post(null == c ? void 0 : c.data, a, { headers: { "Content-Type": "multipart/form-data", Accept: "application/json" } }); case 8: if (u = e.sent, !(null === (o = null == u ? void 0 : u.data) || void 0 === o ? void 0 : o.result)) { e.next = 14; break } return h = u.data.result.variants[0].split(u.data.result.id)[0], e.abrupt("return", { uri: h + u.data.result.id + "/" + (null === (s = dr.app) || void 0 === s ? void 0 : s.thumbnailSize) }); case 14: return e.abrupt("return", { uri: "" }); case 15: case "end": return e.stop() } }), e) }))); return function (t) { return e.apply(this, arguments) } }())); case 5: o = t.sent, n(o), t.next = 13; break; case 9: t.prev = 9, t.t0 = t.catch(0), console.warn(":: ChattyClient uploadFiles error %O", t.t0), i(t.t0.message); case 13: case "end": return t.stop() } }), t, null, [[0, 9]]) }))); return function (e, n) { return t.apply(this, arguments) } }()) } }, { key: "sendJsonMessage", value: function (e) { var t; if (e) return n(n({}, { id: "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (function (e) { var t = 16 * Math.random() | 0; return ("x" == e ? t : 3 & t | 8).toString(16) })), createdAt: new Date, json: e, text: "Json Message", type: O.JSON, by: T.USER, SenderId: null === (t = dr.member) || void 0 === t ? void 0 : t.id }), {}, { Sender: dr.member }); console.warn(":: ChattyChat sendJsonMessage function param error: json param undefined") } }, { key: "addListener", value: function () { var e = this; this.socket ? (this.socket.on(M.CONNECT_DONE, (function (t) { var n; console.debug(":: ChattyChat CONNECT_DONE", t), e.id = null === (n = t.chat) || void 0 === n ? void 0 : n.id, e.onChatConnect && e.onChatConnect(t), e.markAsRead() })), this.socket.on(M.CONNECT_FAIL, (function (t) { console.warn(":: ChattyChat CONNECT_FAIL", t.message), e.onChatConnect && e.onChatConnect({ error: t }) })), this.socket.on(M.FETCH_MESSAGES_DONE, (function (t) { console.debug(":: ChattyChat FETCH_MESSAGES_DONE", t), e.onMessagesFetch && e.onMessagesFetch(t), e.markAsRead() })), this.socket.on(M.FETCH_MESSAGES_FAIL, (function (t) { console.warn(":: ChattyChat FETCH_MESSAGES_FAIL", t.message), e.onMessagesFetch && e.onMessagesFetch({ error: t }) })), this.socket.on(M.SEND_MESSAGE_DONE, (function (t) { console.debug(":: ChattyChat SEND_MESSAGE_DONE", t), e.onMessageSend && e.onMessageSend(t), e.chatlist && e.id && e.chatlist.refreshChat(e.id) })), this.socket.on(M.SEND_MESSAGE_FAIL, (function (t) { console.warn(":: ChattyChat SEND_MESSAGE_FAIL", t.message), e.onMessageSend && e.onMessageSend({ error: t }) })), this.socket.on(M.SEND_MESSAGE_RETRY, (function (t) { var n; console.debug(":: ChattyChat SEND_MESSAGE_RETRY", t), null === (n = e.socket) || void 0 === n || n.emit(M.SEND_MESSAGE, t) })), this.socket.on(M.RECEIVE_MESSAGE, (function (t) { console.debug(":: ChattyChat RECEIVE_MESSAGE", t), e.onMessageReceive && e.onMessageReceive(t), e.markAsRead() })), this.socket.on(M.MARK_AS_READ_DONE, (function (t) { console.debug(":: ChattyChat MARK_AS_READ_DONE", t), e.chatlist && e.id && e.chatlist.refreshChat(e.id) })), this.socket.on(M.MARK_AS_READ_FAIL, (function (e) { console.warn(":: ChattyChat MARK_AS_READ_FAIL", e.message) })), this.socket.on(M.MARK_AS_READ_BYPASS, (function () { console.debug(":: ChattyChat MARK_AS_READ_BYPASS") })), this.socket.on(M.UPDATE_MESSAGES, (function (t) { console.debug(":: ChattyChat UPDATE_MESSAGES", t), e.onMessagesUpdate && e.onMessagesUpdate(t) })), this.socket.on(M.REFRESH_CHAT_DONE, (function (t) { console.debug(":: ChattyChat REFRESH_CHAT_DONE", t), e.onChatRefresh && e.onChatRefresh(t) })), this.socket.on(M.REFRESH_CHAT_FAIL, (function (t) { console.warn(":: ChattyChat REFRESH_CHAT_FAIL", t.message), e.onChatRefresh && e.onChatRefresh({ error: t }) })), this.socket.on(M.LEAVE_CHAT_DONE, (function (t) { console.debug(":: ChattyChat LEAVE_CHAT_DONE", t), e.onChatLeave && e.onChatLeave(t) })), this.socket.on(M.LEAVE_CHAT_FAIL, (function (t) { console.warn(":: ChattyChat LEAVE_CHAT_FAIL", t.message), e.onChatLeave && e.onChatLeave({ error: t }) })), this.socket.on(M.DELETE_MESSAGE_FAIL, (function (t) { console.warn(":: ChattyChat DELETE_MESSAGE_FAIL", t.message), e.onMessagesUpdate && e.onMessagesUpdate({ error: t }) }))) : console.warn(":: ChattyChat socket is not connected") } }, { key: "removeListener", value: function () { this.socket ? (this.socket.off(M.CONNECT_DONE), this.socket.off(M.CONNECT_FAIL), this.socket.off(M.FETCH_MESSAGES_DONE), this.socket.off(M.FETCH_MESSAGES_FAIL), this.socket.off(M.SEND_MESSAGE_DONE), this.socket.off(M.SEND_MESSAGE_FAIL), this.socket.off(M.SEND_MESSAGE_RETRY), this.socket.off(M.RECEIVE_MESSAGE), this.socket.off(M.MARK_AS_READ_DONE), this.socket.off(M.MARK_AS_READ_FAIL), this.socket.off(M.MARK_AS_READ_BYPASS), this.socket.off(M.UPDATE_MESSAGES), this.socket.off(M.REFRESH_CHAT_DONE), this.socket.off(M.REFRESH_CHAT_FAIL), this.socket.off(M.LEAVE_CHAT_DONE), this.socket.off(M.LEAVE_CHAT_FAIL), this.socket.off(M.DELETE_MESSAGE_FAIL), this.socket = void 0, this.chatlist = void 0, this.id = void 0) : console.warn(":: ChattyChat socket is not connected") } }]), e }(); function pr(e, t) { return t ? e.length ? (e.map((function (e) { return e.type ? "image" !== e.type.split("/")[0] || t.enableImageUpload ? "video" !== e.type.split("/")[0] || t.enableVideoUpload ? "image" !== e.type.split("/")[0] || L.includes(e.type) ? "video" !== e.type.split("/")[0] || D.includes(e.type) ? void 0 : (console.warn(":: ChattyClient Video format '".concat(e.type, "' is not supported")), !1) : (console.warn(":: ChattyClient Image format '".concat(e.type, "' is not supported")), !1) : (console.warn(":: ChattyClient Video upload is not enabled"), !1) : (console.warn(":: ChattyClient Image upload is not enabled"), !1) : (console.warn(":: ChattyClient File type is not defined"), !1) })), !0) : (console.warn(":: ChattyClient File param is empty"), !1) : (console.warn(":: ChattyClient App is undefined"), !1) } var dr = function () { function e() { a(this, e) } var t, i, o, c, h, f, l, p, d, y, v; return u(e, null, [{ key: "init", value: (v = s(r().mark((function e(t) { var i, o, s; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (e.prev = 0, t.apiKey) { e.next = 3; break } return e.abrupt("return", Promise.reject({ message: ":: ChattyClient init fail - apiKey is required" })); case 3: if (t.member.id && t.member.name) { e.next = 5; break } return e.abrupt("return", Promise.reject({ message: ":: ChattyClient init fail - member id and member name is required" })); case 5: return o = void 0, this.apiKey = t.apiKey, this.axiosInstance = yr(this.apiKey), s = { platform: navigator.platform, language: navigator.language, product: navigator.product, userAgent: navigator.userAgent, sdkVersion: "1.2.0" }, e.next = 11, this.getApp(); case 11: return this.app = e.sent, e.next = 14, this.upsertMember(n(n({}, t.member), {}, { device: s, AppId: null === (i = this.app) || void 0 === i ? void 0 : i.id })); case 14: if (this.member = e.sent, !this.app || !this.member) { e.next = 22; break } return console.info(":: ChattyClient init success"), console.info(":: ChattyClient [App]", this.app), console.info(":: ChattyClient [Member]", this.member), e.next = 21, this.getMissedCount(); case 21: o = e.sent; case 22: return e.abrupt("return", o); case 25: return e.prev = 25, e.t0 = e.catch(0), e.abrupt("return", Promise.reject({ message: ":: ChattyClient init fail - " + e.t0.message })); case 28: case "end": return e.stop() } }), e, this, [[0, 25]]) }))), function (e) { return v.apply(this, arguments) }) }, { key: "exit", value: (y = s(r().mark((function e(t) { var i; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (e.prev = 0, !this.member) { e.next = 9; break } if (!t.deleteMember) { e.next = 7; break } return e.next = 5, this.deleteMember(this.member.id); case 5: e.next = 9; break; case 7: return e.next = 9, this.upsertMember(n(n({}, this.member), {}, { deviceToken: "", AppId: null === (i = this.app) || void 0 === i ? void 0 : i.id })); case 9: this.apiKey = void 0, this.app = void 0, this.member = void 0, this.axiosInstance = void 0, console.debug(":: ChattyClient exit success"), e.next = 19; break; case 16: e.prev = 16, e.t0 = e.catch(0), console.warn(":: ChattyClient exit fail ", e.t0.message); case 19: case "end": return e.stop() } }), e, this, [[0, 16]]) }))), function (e) { return y.apply(this, arguments) }) }, { key: "getApp", value: (d = s(r().mark((function e() { return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: return e.next = 5, this.axiosInstance.get("/apps").then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: "getApp error - " + e }) })); case 5: return e.abrupt("return", e.sent); case 6: case "end": return e.stop() } }), e, this) }))), function () { return d.apply(this, arguments) }) }, { key: "getChats", value: (p = s(r().mark((function e(t, n) { var i, o; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this.axiosInstance && this.app && this.member || Promise.reject({ message: ":: ChattyClient getChats error - ChattyClient was not initailized" }), e.next = 3, this.axiosInstance.get("/chats", { params: { AppId: this.app.id, page: t, pageLimit: this.app.chatListPageLimit, MemberId: n.MemberId, group: n.group, keyword: n.keyword, order: "updatedAt" } }); case 3: return i = e.sent, o = i.data, e.abrupt("return", o); case 6: case "end": return e.stop() } }), e, this) }))), function (e, t) { return p.apply(this, arguments) }) }, { key: "createChat", value: (l = s(r().mark((function e(t) { var i, o, s, a, c = this; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance && this.app) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: if (!(t.Members && t.Members.length > this.app.chatCapacity)) { e.next = 6; break } return console.warn(":: ChattyClient createChat error - Maximum chat member count exceeded"), e.abrupt("return"); case 6: return a = t.adminMessage, delete t.adminMessage, e.next = 10, this.axiosInstance.post("/chats", n(n({}, t), {}, { image: t.image ? { uri: t.image } : void 0, Members: null === (i = t.Members) || void 0 === i ? void 0 : i.map((function (e) { var t; return { MemberId: e, AppId: null === (t = c.app) || void 0 === t ? void 0 : t.id } })), Messages: a ? [n(n({}, a), {}, { AppId: null === (o = this.app) || void 0 === o ? void 0 : o.id, type: a.json ? O.JSON : O.TEXT, by: T.ADMIN })] : void 0, AppId: null === (s = this.app) || void 0 === s ? void 0 : s.id })).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: ":: ChattyClient createChat error - " + e }) })); case 10: return e.abrupt("return", e.sent); case 11: case "end": return e.stop() } }), e, this) }))), function (e) { return l.apply(this, arguments) }) }, { key: "updateChat", value: (f = s(r().mark((function e(t) { var i, o, s, a, c = this; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance && this.app) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: if (!(t.Members && t.Members.length > this.app.chatCapacity)) { e.next = 6; break } return console.warn(":: ChattyClient updateChat error - Maximum chat member count exceeded"), e.abrupt("return"); case 6: return a = t.adminMessage, delete t.adminMessage, e.next = 10, this.axiosInstance.put("/chats", n(n({}, t), {}, { image: t.image ? { uri: t.image } : void 0, Members: null === (i = t.Members) || void 0 === i ? void 0 : i.map((function (e) { var t; return { MemberId: e, AppId: null === (t = c.app) || void 0 === t ? void 0 : t.id } })), Messages: a ? [n(n({}, a), {}, { AppId: null === (o = this.app) || void 0 === o ? void 0 : o.id, type: a.json ? O.JSON : O.TEXT, by: T.ADMIN })] : void 0, AppId: null === (s = this.app) || void 0 === s ? void 0 : s.id })).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: ":: ChattyClient updateChat error - " + e }) })); case 10: return e.abrupt("return", e.sent); case 11: case "end": return e.stop() } }), e, this) }))), function (e) { return f.apply(this, arguments) }) }, { key: "createAdminMessage", value: (h = s(r().mark((function e(t) { var i, o, s, a, c = this; return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance && this.app) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: if (!(t.Members && t.Members.length > this.app.chatCapacity)) { e.next = 6; break } return console.warn(":: ChattyClient createAdminMessage error - Maximum chat member count exceeded"), e.abrupt("return"); case 6: return a = t.adminMessage, delete t.adminMessage, e.next = 10, this.axiosInstance.post("/messages", n(n({}, t), {}, { image: t.image ? { uri: t.image } : void 0, Members: null === (i = t.Members) || void 0 === i ? void 0 : i.map((function (e) { var t; return { MemberId: e, AppId: null === (t = c.app) || void 0 === t ? void 0 : t.id } })), Messages: a ? [n(n({}, a), {}, { AppId: null === (o = this.app) || void 0 === o ? void 0 : o.id, type: a.json ? O.JSON : O.TEXT, by: T.ADMIN })] : void 0, AppId: null === (s = this.app) || void 0 === s ? void 0 : s.id })).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: ":: ChattyClient createAdminMessage error - " + e }) })); case 10: return e.abrupt("return", e.sent); case 11: case "end": return e.stop() } }), e, this) }))), function (e) { return h.apply(this, arguments) }) }, { key: "getMembers", value: (c = s(r().mark((function e(t) { return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance && this.app) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: return e.next = 5, this.axiosInstance.get("/members", { params: { AppId: this.app.id, group: t.group, ChatId: t.ChatId } }).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: ":: ChattyClient getMembers error - " + e }) })); case 5: return e.abrupt("return", e.sent); case 6: case "end": return e.stop() } }), e, this) }))), function (e) { return c.apply(this, arguments) }) }, { key: "upsertMember", value: (o = s(r().mark((function e(t) { return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: return e.next = 5, this.axiosInstance.put("/members", t).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: "Chatty.upsertMember error - " + e }) })); case 5: return e.abrupt("return", e.sent); case 6: case "end": return e.stop() } }), e, this) }))), function (e) { return o.apply(this, arguments) }) }, { key: "deleteMember", value: (i = s(r().mark((function e(t) { return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance && this.app) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized"), e.abrupt("return"); case 3: return e.next = 5, this.axiosInstance.delete("/members/".concat(t), { params: { AppId: this.app.id } }).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: "Chatty.deleteMember error - " + e }) })); case 5: return e.abrupt("return", e.sent); case 6: case "end": return e.stop() } }), e, this) }))), function (e) { return i.apply(this, arguments) }) }, { key: "generateDistinctKey", value: function () { for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++)t[n] = arguments[n]; if (t && t.length) if (this.app) { t.push(this.app.id); var r = t.sort().toString(); if (!(r.length >= 255)) { var i, o; return o = function (e) { for (var t, n = "0123456789ABCDEF", r = "", i = 0; i < e.length; i++)t = e.charCodeAt(i), r += n.charAt(t >>> 4 & 15) + n.charAt(15 & t); return r }(function (e) { for (var t = "", n = 0; n < 32 * e.length; n += 8)t += String.fromCharCode(e[n >> 5] >>> n % 32 & 255); return t }(function (e, t) { e[t >> 5] |= 128 << t % 32, e[14 + (t + 64 >>> 9 << 4)] = t; for (var n = 1732584193, r = -271733879, i = -1732584194, o = 271733878, s = 0; s < e.length; s += 16) { var l = n, p = r, d = i, y = o; r = h(r = h(r = h(r = h(r = u(r = u(r = u(r = u(r = c(r = c(r = c(r = c(r = a(r = a(r = a(r = a(r, i = a(i, o = a(o, n = a(n, r, i, o, e[s + 0], 7, -680876936), r, i, e[s + 1], 12, -389564586), n, r, e[s + 2], 17, 606105819), o, n, e[s + 3], 22, -1044525330), i = a(i, o = a(o, n = a(n, r, i, o, e[s + 4], 7, -176418897), r, i, e[s + 5], 12, 1200080426), n, r, e[s + 6], 17, -1473231341), o, n, e[s + 7], 22, -45705983), i = a(i, o = a(o, n = a(n, r, i, o, e[s + 8], 7, 1770035416), r, i, e[s + 9], 12, -1958414417), n, r, e[s + 10], 17, -42063), o, n, e[s + 11], 22, -1990404162), i = a(i, o = a(o, n = a(n, r, i, o, e[s + 12], 7, 1804603682), r, i, e[s + 13], 12, -40341101), n, r, e[s + 14], 17, -1502002290), o, n, e[s + 15], 22, 1236535329), i = c(i, o = c(o, n = c(n, r, i, o, e[s + 1], 5, -165796510), r, i, e[s + 6], 9, -1069501632), n, r, e[s + 11], 14, 643717713), o, n, e[s + 0], 20, -373897302), i = c(i, o = c(o, n = c(n, r, i, o, e[s + 5], 5, -701558691), r, i, e[s + 10], 9, 38016083), n, r, e[s + 15], 14, -660478335), o, n, e[s + 4], 20, -405537848), i = c(i, o = c(o, n = c(n, r, i, o, e[s + 9], 5, 568446438), r, i, e[s + 14], 9, -1019803690), n, r, e[s + 3], 14, -187363961), o, n, e[s + 8], 20, 1163531501), i = c(i, o = c(o, n = c(n, r, i, o, e[s + 13], 5, -1444681467), r, i, e[s + 2], 9, -51403784), n, r, e[s + 7], 14, 1735328473), o, n, e[s + 12], 20, -1926607734), i = u(i, o = u(o, n = u(n, r, i, o, e[s + 5], 4, -378558), r, i, e[s + 8], 11, -2022574463), n, r, e[s + 11], 16, 1839030562), o, n, e[s + 14], 23, -35309556), i = u(i, o = u(o, n = u(n, r, i, o, e[s + 1], 4, -1530992060), r, i, e[s + 4], 11, 1272893353), n, r, e[s + 7], 16, -155497632), o, n, e[s + 10], 23, -1094730640), i = u(i, o = u(o, n = u(n, r, i, o, e[s + 13], 4, 681279174), r, i, e[s + 0], 11, -358537222), n, r, e[s + 3], 16, -722521979), o, n, e[s + 6], 23, 76029189), i = u(i, o = u(o, n = u(n, r, i, o, e[s + 9], 4, -640364487), r, i, e[s + 12], 11, -421815835), n, r, e[s + 15], 16, 530742520), o, n, e[s + 2], 23, -995338651), i = h(i, o = h(o, n = h(n, r, i, o, e[s + 0], 6, -198630844), r, i, e[s + 7], 10, 1126891415), n, r, e[s + 14], 15, -1416354905), o, n, e[s + 5], 21, -57434055), i = h(i, o = h(o, n = h(n, r, i, o, e[s + 12], 6, 1700485571), r, i, e[s + 3], 10, -1894986606), n, r, e[s + 10], 15, -1051523), o, n, e[s + 1], 21, -2054922799), i = h(i, o = h(o, n = h(n, r, i, o, e[s + 8], 6, 1873313359), r, i, e[s + 15], 10, -30611744), n, r, e[s + 6], 15, -1560198380), o, n, e[s + 13], 21, 1309151649), i = h(i, o = h(o, n = h(n, r, i, o, e[s + 4], 6, -145523070), r, i, e[s + 11], 10, -1120210379), n, r, e[s + 2], 15, 718787259), o, n, e[s + 9], 21, -343485551), n = f(n, l), r = f(r, p), i = f(i, d), o = f(o, y) } return Array(n, r, i, o) }(function (e) { for (var t = Array(e.length >> 2), n = 0; n < t.length; n++)t[n] = 0; for (n = 0; n < 8 * e.length; n += 8)t[n >> 5] |= (255 & e.charCodeAt(n / 8)) << n % 32; return t }(i = r), 8 * i.length))), o.toLowerCase() } console.warn(":: ChattyClient generateDistinctKey error - md5 input string is too long") } else console.warn(":: ChattyClient generateDistinctKey error - Chatty was not initialized"); else console.warn(":: ChattyClient generateDistinctKey error - param data is undefined"); function s(e, t, n, r, i, o) { return f(function (e, t) { return e << t | e >>> 32 - t }(f(f(t, e), f(r, o)), i), n) } function a(e, t, n, r, i, o, a) { return s(t & n | ~t & r, e, t, i, o, a) } function c(e, t, n, r, i, o, a) { return s(t & r | n & ~r, e, t, i, o, a) } function u(e, t, n, r, i, o, a) { return s(t ^ n ^ r, e, t, i, o, a) } function h(e, t, n, r, i, o, a) { return s(n ^ (t | ~r), e, t, i, o, a) } function f(e, t) { var n = (65535 & e) + (65535 & t); return (e >> 16) + (t >> 16) + (n >> 16) << 16 | 65535 & n } } }, { key: "getMissedCount", value: (t = s(r().mark((function e() { return r().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.axiosInstance && this.member) { e.next = 3; break } return console.warn(":: ChattyClient was not initailized (at getMissedCount)"), e.abrupt("return"); case 3: return e.next = 5, this.axiosInstance.get("/missed-count", { params: { MemberId: this.member.id } }).then((function (e) { return Promise.resolve(e.data) })).catch((function (e) { return Promise.reject({ message: ":: ChattyClient getMissedCount error - " + e }) })); case 5: return e.abrupt("return", e.sent); case 6: case "end": return e.stop() } }), e, this) }))), function () { return t.apply(this, arguments) }) }]), e }(); function yr(e) { var t = Gt.create(); return t.defaults.baseURL = "https://devapi.chatty-cloud.com", t.defaults.headers.common.ApiKey = e || "", t.defaults.headers.common["Content-Type"] = "application/json", t.interceptors.request.use((function (e) { return e }), (function (e) { return Promise.reject({ message: ":: ChattyClient Error 1 - " + e.message }) })), t.interceptors.response.use((function (e) { return e }), (function (e) { return e.response ? e.response.data ? Promise.reject({ message: ":: ChattyClient Error 3 - " + e.response.data.message }) : Promise.reject({ message: ":: ChattyClient Error 2 - " + e.response._response }) : e.request ? Promise.reject({ message: ":: ChattyClient Error - Please check network state" }) : Promise.reject({ message: ":: ChattyClient Error 4 - " + e.message }) })), t } e.ChattyChat = lr, e.ChattyTypes = I, e.default = dr, Object.defineProperty(e, "__esModule", { value: !0 }) }));
//# sourceMappingURL=chatty-client.min.js.map
